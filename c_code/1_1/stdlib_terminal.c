/* Generated by Nim Compiler v0.17.0 */
/*   (c) 2017 Andreas Rumpf */
/* The generated code is subject to the original license. */
#define NIM_NEW_MANGLING_RULES
#define NIM_INTBITS 32

#include "nimbase.h"
#include <string.h>
#include <stdio.h>
#include <io.h>
#undef linux
#undef near
typedef struct TGenericSeq TGenericSeq;
typedef struct NimStringDesc NimStringDesc;
typedef struct CONSOLE_SCREEN_BUFFER_INFO_r6d5R6U7A9aP1xHUbo2o04A CONSOLE_SCREEN_BUFFER_INFO_r6d5R6U7A9aP1xHUbo2o04A;
typedef struct COORD_38Oq1GgFPIYv2ksRi9c0fZA COORD_38Oq1GgFPIYv2ksRi9c0fZA;
typedef struct SMALL_RECT_GSDbaE1SdabWptSZYJG3XA SMALL_RECT_GSDbaE1SdabWptSZYJG3XA;
typedef N_STDCALL_PTR(NI, TY_zP2zGemcuVRvOUE82f9a0Pw) (NI32 nStdHandle);
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
typedef N_STDCALL_PTR(NI32, TY_oew1DfaGl5XhHmnBK0HYXQ) (NI hSourceProcessHandle, NI hSourceHandle, NI hTargetProcessHandle, NI* lpTargetHandle, NI32 dwDesiredAccess, NI32 bInheritHandle, NI32 dwOptions);
typedef N_STDCALL_PTR(NI, TY_uryidYWkntM7ddjZSyxvyQ) (void);
struct  COORD_38Oq1GgFPIYv2ksRi9c0fZA  {
NI16 X;
NI16 Y;
};
struct  SMALL_RECT_GSDbaE1SdabWptSZYJG3XA  {
NI16 Left;
NI16 Top;
NI16 Right;
NI16 Bottom;
};
struct  CONSOLE_SCREEN_BUFFER_INFO_r6d5R6U7A9aP1xHUbo2o04A  {
COORD_38Oq1GgFPIYv2ksRi9c0fZA dwSize;
COORD_38Oq1GgFPIYv2ksRi9c0fZA dwCursorPosition;
NI16 wAttributes;
SMALL_RECT_GSDbaE1SdabWptSZYJG3XA srWindow;
COORD_38Oq1GgFPIYv2ksRi9c0fZA dwMaximumWindowSize;
};
typedef N_STDCALL_PTR(NI32, TY_vjGHiWUJwFzOgSxDffBb6Q) (NI hConsoleOutput, CONSOLE_SCREEN_BUFFER_INFO_r6d5R6U7A9aP1xHUbo2o04A* lpConsoleScreenBufferInfo);
typedef NU8 Style_NXKayqTLMsAibFwNceBlpA_Set;
typedef NU8 Style_NXKayqTLMsAibFwNceBlpA;
typedef N_STDCALL_PTR(NI32, TY_oPCjp4xTgEl9a8fqSzOv8lw) (NI hConsoleOutput, NI16 wAttributes);
typedef NU8 ForegroundColor_ez9ah4IgQc0AbdW68acioDg;
typedef NI TY_e7dTfxuKO1YfQGLA3anCHg[8];
N_NIMCALL(void*, nimLoadLibrary)(NimStringDesc* path);
N_NOINLINE(void, nimLoadLibraryError)(NimStringDesc* path);
N_NIMCALL(void*, nimGetProcAddr)(void* lib, NCSTRING name);
N_NIMCALL(NI16, getAttributes_PnaHeFPQ8QlJWgnEjaRyCg)(NI h);
N_NIMCALL(int, getFileHandle_bZ9c2yojtXoDTUpfyl8h8Rg)(FILE* f);
NI hStdout_Q6LBG8sK28zNgldP5VHBBA;
NI hStderr_6C9cOGHD37RMptVLFSz9ckEQ;
NI hStdoutTemp_Frgc1hZhHtHmhQpuiOhypw;
extern TY_zP2zGemcuVRvOUE82f9a0Pw Dl_127820_;
static void* TM_CN3raB9atujkEiPpxYAdlgQ_2;
TY_oew1DfaGl5XhHmnBK0HYXQ Dl_195038_;
TY_uryidYWkntM7ddjZSyxvyQ Dl_195048_;
NI hStderrTemp_lkKJFEg9bMgFJ9bv6dAcceSQ;
NI16 oldStdoutAttr_vkHOZle9bmebv77fjQpEGqw;
TY_vjGHiWUJwFzOgSxDffBb6Q Dl_195050_;
NI16 oldStderrAttr_ZXyw45dCi8lkCMLSUcaIBw;
TY_oPCjp4xTgEl9a8fqSzOv8lw Dl_195159_;
STRING_LITERAL(TM_CN3raB9atujkEiPpxYAdlgQ_4, "kernel32", 8);
STRING_LITERAL(TM_CN3raB9atujkEiPpxYAdlgQ_5, "kernel32", 8);
NIM_CONST TY_e7dTfxuKO1YfQGLA3anCHg lookup_iBTamPHB6H8lJIzDyv8epw = {((NI) 0),
((NI) 4),
((NI) 2),
((NI) 6),
((NI) 1),
((NI) 5),
((NI) 3),
((NI) 7)}
;

N_NIMCALL(NI16, getAttributes_PnaHeFPQ8QlJWgnEjaRyCg)(NI h) {
	NI16 result;
	CONSOLE_SCREEN_BUFFER_INFO_r6d5R6U7A9aP1xHUbo2o04A c;
{	result = (NI16)0;
	memset((void*)(&c), 0, sizeof(c));
	{
		NI32 T3_;
		T3_ = (NI32)0;
		T3_ = Dl_195050_(h, (&c));
		if (!!((T3_ == ((NI32) 0)))) goto LA4_;
		result = c.wAttributes;
		goto BeforeRet_;
	}
	LA4_: ;
	result = ((NI16) 112);
	goto BeforeRet_;
	}BeforeRet_: ;
	return result;
}

N_NIMCALL(void, setStyle_GclWadYUouE9aXrU2KZQtoQ)(FILE* f, Style_NXKayqTLMsAibFwNceBlpA_Set style) {
	NI h;
	NI16 old;
	NI16 T6_;
	NI16 a;
	NI32 T23_;
	{
		if (!(f == stderr)) goto LA3_;
		h = hStderr_6C9cOGHD37RMptVLFSz9ckEQ;
	}
	goto LA1_;
	LA3_: ;
	{
		h = hStdout_Q6LBG8sK28zNgldP5VHBBA;
	}
	LA1_: ;
	T6_ = (NI16)0;
	T6_ = getAttributes_PnaHeFPQ8QlJWgnEjaRyCg(h);
	old = (NI16)(T6_ & ((NI16) 119));
	a = ((NI16) 0);
	{
		if (!((style &(1U<<((NU)((((Style_NXKayqTLMsAibFwNceBlpA) 1)- 1))&7U)))!=0)) goto LA9_;
		a = (NI16)(a | ((NI16) 8));
	}
	LA9_: ;
	{
		if (!((style &(1U<<((NU)((((Style_NXKayqTLMsAibFwNceBlpA) 5)- 1))&7U)))!=0)) goto LA13_;
		a = (NI16)(a | ((NI16) 128));
	}
	LA13_: ;
	{
		if (!((style &(1U<<((NU)((((Style_NXKayqTLMsAibFwNceBlpA) 7)- 1))&7U)))!=0)) goto LA17_;
		a = (NI16)(a | ((NI16) 16384));
	}
	LA17_: ;
	{
		if (!((style &(1U<<((NU)((((Style_NXKayqTLMsAibFwNceBlpA) 4)- 1))&7U)))!=0)) goto LA21_;
		a = (NI16)(a | ((NI16) -32768));
	}
	LA21_: ;
	T23_ = (NI32)0;
	T23_ = Dl_195159_(h, (NI16)(old | a));
}

N_NIMCALL(void, resetAttributes_6DYwjcHkAz0BG9bT24wH4dw)(FILE* f) {
	{
		NI32 T5_;
		if (!(f == stderr)) goto LA3_;
		T5_ = (NI32)0;
		T5_ = Dl_195159_(hStderr_6C9cOGHD37RMptVLFSz9ckEQ, oldStderrAttr_ZXyw45dCi8lkCMLSUcaIBw);
	}
	goto LA1_;
	LA3_: ;
	{
		NI32 T7_;
		T7_ = (NI32)0;
		T7_ = Dl_195159_(hStdout_Q6LBG8sK28zNgldP5VHBBA, oldStdoutAttr_vkHOZle9bmebv77fjQpEGqw);
	}
	LA1_: ;
}

N_NIMCALL(void, setForegroundColor_Tw7yxMupneOmAicqiYt3NA)(FILE* f, ForegroundColor_ez9ah4IgQc0AbdW68acioDg fg, NIM_BOOL bright) {
	NI h;
	NI16 old;
	NI16 T6_;
	NI32 T11_;
	{
		if (!(f == stderr)) goto LA3_;
		h = hStderr_6C9cOGHD37RMptVLFSz9ckEQ;
	}
	goto LA1_;
	LA3_: ;
	{
		h = hStdout_Q6LBG8sK28zNgldP5VHBBA;
	}
	LA1_: ;
	T6_ = (NI16)0;
	T6_ = getAttributes_PnaHeFPQ8QlJWgnEjaRyCg(h);
	old = (NI16)(T6_ & ((NI16) -8));
	{
		if (!bright) goto LA9_;
		old = (NI16)(old | ((NI16) 8));
	}
	LA9_: ;
	T11_ = (NI32)0;
	T11_ = Dl_195159_(h, ((NI16)(NU16)(NU)((NI)(((NI) (old)) | lookup_iBTamPHB6H8lJIzDyv8epw[(fg)- 30]))));
}

N_NIMCALL(NIM_BOOL, isatty_POoHvosCWg3Yl5ieYeLHrg)(FILE* f) {
	NIM_BOOL result;
	int T1_;
	int T2_;
	result = (NIM_BOOL)0;
	T1_ = (int)0;
	T1_ = getFileHandle_bZ9c2yojtXoDTUpfyl8h8Rg(f);
	T2_ = (int)0;
	T2_ = _isatty(T1_);
	result = !((T2_ == ((NI32) 0)));
	return result;
}
NIM_EXTERNC N_NOINLINE(void, stdlib_terminalInit000)(void) {
	{
		hStdoutTemp_Frgc1hZhHtHmhQpuiOhypw = Dl_127820_(((NI32) -11));
		{
			NI T4_;
			NI T5_;
			NI32 T6_;
			T4_ = (NI)0;
			T4_ = Dl_195048_();
			T5_ = (NI)0;
			T5_ = Dl_195048_();
			T6_ = (NI32)0;
			T6_ = Dl_195038_(T4_, hStdoutTemp_Frgc1hZhHtHmhQpuiOhypw, T5_, (&hStdout_Q6LBG8sK28zNgldP5VHBBA), ((NI32) 0), ((NI32) 1), ((NI32) 2));
			if (!(T6_ == ((NI32) 0))) goto LA7_;
		}
		LA7_: ;
		hStderrTemp_lkKJFEg9bMgFJ9bv6dAcceSQ = Dl_127820_(((NI32) -12));
		{
			NI T11_;
			NI T12_;
			NI32 T13_;
			T11_ = (NI)0;
			T11_ = Dl_195048_();
			T12_ = (NI)0;
			T12_ = Dl_195048_();
			T13_ = (NI32)0;
			T13_ = Dl_195038_(T11_, hStderrTemp_lkKJFEg9bMgFJ9bv6dAcceSQ, T12_, (&hStderr_6C9cOGHD37RMptVLFSz9ckEQ), ((NI32) 0), ((NI32) 1), ((NI32) 2));
			if (!(T13_ == ((NI32) 0))) goto LA14_;
		}
		LA14_: ;
	}
	oldStdoutAttr_vkHOZle9bmebv77fjQpEGqw = getAttributes_PnaHeFPQ8QlJWgnEjaRyCg(hStdout_Q6LBG8sK28zNgldP5VHBBA);
	oldStderrAttr_ZXyw45dCi8lkCMLSUcaIBw = getAttributes_PnaHeFPQ8QlJWgnEjaRyCg(hStderr_6C9cOGHD37RMptVLFSz9ckEQ);
}

NIM_EXTERNC N_NOINLINE(void, stdlib_terminalDatInit000)(void) {
if (!((TM_CN3raB9atujkEiPpxYAdlgQ_2 = nimLoadLibrary((NimStringDesc*) &TM_CN3raB9atujkEiPpxYAdlgQ_4))
)) nimLoadLibraryError((NimStringDesc*) &TM_CN3raB9atujkEiPpxYAdlgQ_5);
	Dl_195038_ = (TY_oew1DfaGl5XhHmnBK0HYXQ) nimGetProcAddr(TM_CN3raB9atujkEiPpxYAdlgQ_2, "DuplicateHandle");
	Dl_195048_ = (TY_uryidYWkntM7ddjZSyxvyQ) nimGetProcAddr(TM_CN3raB9atujkEiPpxYAdlgQ_2, "GetCurrentProcess");
	Dl_195050_ = (TY_vjGHiWUJwFzOgSxDffBb6Q) nimGetProcAddr(TM_CN3raB9atujkEiPpxYAdlgQ_2, "GetConsoleScreenBufferInfo");
	Dl_195159_ = (TY_oPCjp4xTgEl9a8fqSzOv8lw) nimGetProcAddr(TM_CN3raB9atujkEiPpxYAdlgQ_2, "SetConsoleTextAttribute");
}

