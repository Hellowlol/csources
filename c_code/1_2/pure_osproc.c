/* Generated by Nimrod Compiler v0.9.3 */
/*   (c) 2012 Andreas Rumpf */
/* The generated code is subject to the original license. */
#define NIM_INTBITS 64
#include "nimbase.h"

#include <string.h>

#include <stdio.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct tprocess145203 tprocess145203;
typedef struct TY9552 TY9552;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct tcell38646 tcell38646;
typedef struct tcellseq38662 tcellseq38662;
typedef struct tgcheap40616 tgcheap40616;
typedef struct tcellset38658 tcellset38658;
typedef struct tpagedesc38654 tpagedesc38654;
typedef struct tmemregion22010 tmemregion22010;
typedef struct tsmallchunk21238 tsmallchunk21238;
typedef struct tllchunk22004 tllchunk22004;
typedef struct tbigchunk21240 tbigchunk21240;
typedef struct tintset21215 tintset21215;
typedef struct ttrunk21211 ttrunk21211;
typedef struct tavlnode22008 tavlnode22008;
typedef struct tgcstat40614 tgcstat40614;
typedef struct TNimObject TNimObject;
typedef struct TY146202 TY146202;
typedef struct tstream143629 tstream143629;
typedef struct tfilehandlestream146605 tfilehandlestream146605;
typedef struct tstringtable113610 tstringtable113610;
typedef struct tkeyvaluepairseq113608 tkeyvaluepairseq113608;
typedef struct TY92504 TY92504;
typedef struct tsecurityattributes89653 tsecurityattributes89653;
typedef struct tstartupinfo89655 tstartupinfo89655;
typedef struct tprocessinformation89657 tprocessinformation89657;
typedef struct TY77088 TY77088;
typedef struct tbasechunk21236 tbasechunk21236;
typedef struct tfreecell21228 tfreecell21228;
struct TGenericSeq {
NI len;
NI reserved;
};
typedef NIM_CHAR TY611[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY611 data;
};
typedef NU8 TY114118[32];
typedef N_NIMCALL_PTR(void, TY889) (void* p, NI op);
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY889 marker;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct tcell38646 {
NI Refcount;
TNimType* Typ;
};
struct tcellseq38662 {
NI Len;
NI Cap;
tcell38646** D;
};
struct tcellset38658 {
NI Counter;
NI Max;
tpagedesc38654* Head;
tpagedesc38654** Data;
};
typedef tsmallchunk21238* TY22022[512];
typedef ttrunk21211* ttrunkbuckets21213[256];
struct tintset21215 {
ttrunkbuckets21213 Data;
};
struct tmemregion22010 {
NI Minlargeobj;
NI Maxlargeobj;
TY22022 Freesmallchunks;
tllchunk22004* Llmem;
NI Currmem;
NI Maxmem;
NI Freemem;
NI Lastsize;
tbigchunk21240* Freechunkslist;
tintset21215 Chunkstarts;
tavlnode22008* Root;
tavlnode22008* Deleted;
tavlnode22008* Last;
tavlnode22008* Freeavlnodes;
};
struct tgcstat40614 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
NI64 Maxpause;
};
struct tgcheap40616 {
void* Stackbottom;
NI Cyclethreshold;
tcellseq38662 Zct;
tcellseq38662 Decstack;
tcellset38658 Cycleroots;
tcellseq38662 Tempstack;
NI Recgclock;
tmemregion22010 Region;
tgcstat40614 Stat;
};
struct TNimObject {
TNimType* m_type;
};
struct tprocess145203 {
  TNimObject Sup;
NI Fprocesshandle;
int Inhandle;
int Outhandle;
int Errhandle;
NI Id;
int Exitcode;
};
typedef N_NIMCALL_PTR(void, TY143630) (tstream143629* s);
typedef N_NIMCALL_PTR(NIM_BOOL, TY143634) (tstream143629* s);
typedef N_NIMCALL_PTR(void, TY143638) (tstream143629* s, NI pos);
typedef N_NIMCALL_PTR(NI, TY143643) (tstream143629* s);
typedef N_NIMCALL_PTR(NI, TY143647) (tstream143629* s, void* buffer, NI buflen);
typedef N_NIMCALL_PTR(void, TY143653) (tstream143629* s, void* buffer, NI buflen);
typedef N_NIMCALL_PTR(void, TY143659) (tstream143629* s);
struct tstream143629 {
  TNimObject Sup;
TY143630 Closeimpl;
TY143634 Atendimpl;
TY143638 Setpositionimpl;
TY143643 Getpositionimpl;
TY143647 Readdataimpl;
TY143653 Writedataimpl;
TY143659 Flushimpl;
};
struct tfilehandlestream146605 {
  tstream143629 Sup;
NI Handle;
NIM_BOOL Attheend;
};
typedef N_STDCALL_PTR(NI32, TY89825) (NI hfile, void* buffer, NI32 nnumberofbytestoread, NI32* lpnumberofbytesread, void* lpoverlapped);
typedef N_STDCALL_PTR(NI32, TY89834) (NI hfile, void* buffer, NI32 nnumberofbytestowrite, NI32* lpnumberofbyteswritten, void* lpoverlapped);
struct TY92504 {
NimStringDesc* Field0;
NimStringDesc* Field1;
};
struct tstringtable113610 {
  TNimObject Sup;
NI Counter;
tkeyvaluepairseq113608* Data;
NU8 Mode;
};
struct tsecurityattributes89653 {
NI32 Nlength;
void* Lpsecuritydescriptor;
NI32 Binherithandle;
};
typedef N_STDCALL_PTR(NI32, TY89843) (NI* hreadpipe, NI* hwritepipe, tsecurityattributes89653* lppipeattributes, NI32 nsize);
typedef N_STDCALL_PTR(NI32, TY89821) (NI hobject);
struct tstartupinfo89655 {
NI32 Cb;
NCSTRING Lpreserved;
NCSTRING Lpdesktop;
NCSTRING Lptitle;
NI32 Dwx;
NI32 Dwy;
NI32 Dwxsize;
NI32 Dwysize;
NI32 Dwxcountchars;
NI32 Dwycountchars;
NI32 Dwfillattribute;
NI32 Dwflags;
NI16 Wshowwindow;
NI16 Cbreserved2;
void* Lpreserved2;
NI Hstdinput;
NI Hstdoutput;
NI Hstderror;
};
struct tprocessinformation89657 {
NI Hprocess;
NI Hthread;
NI32 Dwprocessid;
NI32 Dwthreadid;
};
typedef N_STDCALL_PTR(NI, TY90027) (NI32 nstdhandle);
typedef N_STDCALL_PTR(NI32, TY89852) (NI16* lpapplicationname, NI16* lpcommandline, tsecurityattributes89653* lpprocessattributes, tsecurityattributes89653* lpthreadattributes, NI32 binherithandles, NI32 dwcreationflags, NI16* lpenvironment, NI16* lpcurrentdirectory, tstartupinfo89655* lpstartupinfo, tprocessinformation89657* lpprocessinformation);
typedef N_STDCALL_PTR(NI32, TY90003) (NI hthread);
typedef N_STDCALL_PTR(NI32, TY90007) (NI hthread);
typedef N_STDCALL_PTR(NI32, TY90011) (NI hhandle, NI32 dwmilliseconds);
typedef N_STDCALL_PTR(NI32, TY90016) (NI hprocess, NI uexitcode);
typedef N_STDCALL_PTR(NI32, TY90021) (NI hprocess, NI32* lpexitcode);
typedef NI twohandlearray91373[64];
typedef N_STDCALL_PTR(NI32, TY91379) (NI32 ncount, NI* lphandles, NI32 bwaitall, NI32 dwmilliseconds);
struct TY77088 {
NimStringDesc* Field0;
NI Field1;
};
typedef NI TY21218[8];
struct tpagedesc38654 {
tpagedesc38654* Next;
NI Key;
TY21218 Bits;
};
struct tbasechunk21236 {
NI Prevsize;
NI Size;
NIM_BOOL Used;
};
struct tsmallchunk21238 {
  tbasechunk21236 Sup;
tsmallchunk21238* Next;
tsmallchunk21238* Prev;
tfreecell21228* Freelist;
NI Free;
NI Acc;
NF Data;
};
struct tllchunk22004 {
NI Size;
NI Acc;
tllchunk22004* Next;
};
struct tbigchunk21240 {
  tbasechunk21236 Sup;
tbigchunk21240* Next;
tbigchunk21240* Prev;
NI Align;
NF Data;
};
struct ttrunk21211 {
ttrunk21211* Next;
NI Key;
TY21218 Bits;
};
typedef tavlnode22008* TY22014[2];
struct tavlnode22008 {
TY22014 Link;
NI Key;
NI Upperbound;
NI Level;
};
struct tfreecell21228 {
tfreecell21228* Next;
NI Zerofield;
};
struct TY9552 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY146202 {
  TGenericSeq Sup;
  tprocess145203* data[SEQ_DECL_SIZE];
};
struct tkeyvaluepairseq113608 {
  TGenericSeq Sup;
  TY92504 data[SEQ_DECL_SIZE];
};
N_NIMCALL(NimStringDesc*, nospquoteShellWindows)(NimStringDesc* s);
N_NIMCALL(NIM_BOOL, contains_86683)(NimStringDesc* s, TY114118 chars);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* dest, NI addlen);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* s, NIM_CHAR c);
N_NIMCALL(NimStringDesc*, setLengthStr)(NimStringDesc* s, NI newlen);
static N_INLINE(NI, addInt)(NI a, NI b);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(void, nimFrame)(TFrame* s);
static N_INLINE(void, popFrame)(void);
N_NIMCALL(NimStringDesc*, nospquoteShellPosix)(NimStringDesc* s);
N_NIMCALL(NIM_BOOL, allcharsinset_86306)(NimStringDesc* s, TY114118 theset);
N_NIMCALL(NimStringDesc*, nsuReplaceStr)(NimStringDesc* s, NimStringDesc* sub, NimStringDesc* by);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
N_NIMCALL(NimStringDesc*, nospquoteShell)(NimStringDesc* s);
N_NIMCALL(tprocess145203*, startcmd_145428)(NimStringDesc* command, NU8 options);
N_NIMCALL(TY9552*, nosparseCmdLine)(NimStringDesc* c);
static N_INLINE(NI, subInt)(NI a, NI b);
N_NIMCALL(void*, newSeq)(TNimType* typ, NI len);
N_NIMCALL(NimStringDesc*, copyStringRC1)(NimStringDesc* src);
static N_INLINE(void, nimGCunrefNoCycle)(void* p);
static N_INLINE(tcell38646*, usrtocell_42039)(void* usr);
static N_INLINE(void, rtladdzct_43602)(tcell38646* c);
N_NOINLINE(void, addzct_42015)(tcellseq38662* s, tcell38646* c);
N_NIMCALL(NI, nospprocessID)(tprocess145203* p);
N_NIMCALL(int, nospinputHandle)(tprocess145203* p);
N_NIMCALL(int, nospoutputHandle)(tprocess145203* p);
N_NIMCALL(int, nosperrorHandle)(tprocess145203* p);
N_NIMCALL(NI, nospcountProcessors)(void);
N_NIMCALL(NimStringDesc*, getenv_104824)(NimStringDesc* key);
N_NIMCALL(NI, nsuParseInt)(NimStringDesc* s);
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** cmds, NI cmdsLen0, NU8 options, NI n);
N_NIMCALL(void, hiddenraiseassert_77217)(NimStringDesc* msg);
N_NIMCALL(void, TMP971)(void* p, NI op);
N_NIMCALL(void, nimGCvisit)(void* d, NI op);
N_NIMCALL(void, TMP972)(void* p, NI op);
static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src);
N_NIMCALL(void, nossleep)(NI milsecs);
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* command, NU8 options);
N_NIMCALL(NimStringDesc*, rawNewString)(NI cap);
N_NIMCALL(NIM_BOOL, readline_143973)(tstream143629* s, NimStringDesc** line);
N_NIMCALL(void, del_147834)(TY146202** x, NI i);
N_NIMCALL(void, hsclose_146608)(tstream143629* s);
N_NIMCALL(NIM_BOOL, hsatend_146612)(tstream143629* s);
N_NIMCALL(void, chckObj)(TNimType* obj, TNimType* subclass);
N_NIMCALL(NI, hsreaddata_146617)(tstream143629* s_146619, void* buffer, NI buflen);
static N_INLINE(NI, chckRange)(NI i, NI a, NI b);
N_NOINLINE(void, raiseRangeError)(NI64 val);
N_NIMCALL(void, oserror_97226)(NI32 errorcode);
N_NIMCALL(NI32, oslasterror_97267)(void);
N_NIMCALL(void, hswritedata_146630)(tstream143629* s_146632, void* buffer, NI buflen);
N_NIMCALL(tfilehandlestream146605*, newfilehandlestream_146641)(NI handle);
N_NIMCALL(void, TMP981)(void* p, NI op);
N_NIMCALL(void*, newObj)(TNimType* typ, NI size);
N_NIMCALL(NCSTRING, buildcommandline_146658)(NimStringDesc* a, NimStringDesc** args, NI argsLen0);
N_NOCONV(void*, alloc0_4004)(NI size);
N_NIMCALL(NCSTRING, buildenv_146682)(tstringtable113610* env);
N_NIMCALL(void, createpipehandles_146729)(NI* rdhandle, NI* wrhandle);
static N_INLINE(void, fileclose_146742)(NI h);
N_NIMCALL(tprocess145203*, nospstartProcess)(NimStringDesc* command, NimStringDesc* workingdir, NimStringDesc** args, NI argsLen0, tstringtable113610* env, NU8 options);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING str);
N_NIMCALL(NI16*, newwidecstring_70519)(NCSTRING s);
N_NOCONV(void, dealloc_4011)(void* p);
N_NIMCALL(void, nospsuspend)(tprocess145203* p);
N_NIMCALL(void, nospresume)(tprocess145203* p);
N_NIMCALL(NIM_BOOL, nosprunning)(tprocess145203* p);
N_NIMCALL(void, nospterminate)(tprocess145203* p);
N_NIMCALL(NI, nospwaitForExit)(tprocess145203* p, NI timeout);
N_NIMCALL(NI, peekexitcode_145513)(tprocess145203* p);
N_NIMCALL(tstream143629*, nospinputStream)(tprocess145203* p);
N_NIMCALL(tstream143629*, nospoutputStream)(tprocess145203* p);
N_NIMCALL(tstream143629*, nosperrorStream)(tprocess145203* p);
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* command);
N_NIMCALL(NI16*, newwidecstring_70603)(NimStringDesc* s);
N_NIMCALL(NI, select_146502)(TY146202** readfds, NI timeout);
N_NIMCALL(void, execcmdex_148002)(NimStringDesc* command, NU8 options, TY77088* Result);
N_NIMCALL(void, unsureAsgnRef)(void** dest, void* src);
N_NIMCALL(void, nospclose)(tprocess145203* p);
static NIM_CONST TY114118 TMP942 = {
0x00, 0x02, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP943, "", 0);
STRING_LITERAL(TMP944, "\"", 1);
STRING_LITERAL(TMP945, "\\\"", 2);
NIM_CONST TY114118 safeunixchars_145236 = {
0x00, 0x00, 0x00, 0x00, 0x20, 0xE8, 0xFF, 0x27,
0xFF, 0xFF, 0xFF, 0x87, 0xFE, 0xFF, 0xFF, 0x07,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP946, "\'\'", 2);
static NIM_CONST TY114118 TMP947 = {
0x00, 0x00, 0x00, 0x00, 0x20, 0xE8, 0xFF, 0x27,
0xFF, 0xFF, 0xFF, 0x87, 0xFE, 0xFF, 0xFF, 0x07,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP948, "\'", 1);
STRING_LITERAL(TMP952, "\'\"\'\"\'", 5);
STRING_LITERAL(TMP961, "NUMBER_OF_PROCESSORS", 20);
STRING_LITERAL(TMP969, "0 < n ", 6);
STRING_LITERAL(TMP976, "", 0);
STRING_LITERAL(TMP977, "\015\012", 2);
STRING_LITERAL(TMP986, "=", 1);
STRING_LITERAL(TMP989, "len(readfds) <= 0x00000040 ", 27);
NIM_CONST TY77088 TMP992 = {((NimStringDesc*) &TMP976),
-1}
;
extern TFrame* frameptr_12037;
extern TNimType NTI9552; /* seq[string] */
extern tgcheap40616 gch_40644;
extern TNimType NTI1009; /* TObject */
TNimType NTI145203; /* TProcess */
extern TNimType NTI89641; /* THandle */
extern TNimType NTI9008; /* TFileHandle */
extern TNimType NTI3809; /* cint */
TNimType NTI145205; /* PProcess */
TNimType NTI146202; /* seq[PProcess] */
extern TNimType NTI143629; /* TStream */
TNimType NTI146605; /* TFileHandleStream */
extern TNimType NTI133; /* bool */
extern TY89825 Dl_89824;
extern TY89834 Dl_89833;
TNimType NTI146603; /* PFileHandleStream */
extern TY89843 Dl_89842;
extern TY89821 Dl_89820;
extern TY90027 Dl_90026;
extern TY89852 Dl_89851;
extern TY90003 Dl_90002;
extern TY90007 Dl_90006;
extern TY90011 Dl_90010;
extern TY90016 Dl_90015;
extern TY90021 Dl_90020;
extern TY91379 Dl_91378;

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	memcpy(((NCSTRING) (&(*dest).data[((*dest).Sup.len)- 0])), ((NCSTRING) ((*src).data)), (NI64)((*src).Sup.len + 1));	(*dest).Sup.len += (*src).Sup.len;
}
static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU64)(a) + (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}	LA5: ;
	raiseOverflow();	BeforeRet: ;	return result;
}
static N_INLINE(void, nimFrame)(TFrame* s) {
	(*s).prev = frameptr_12037;
	frameptr_12037 = s;
}
static N_INLINE(void, popFrame)(void) {
	frameptr_12037 = (*frameptr_12037).prev;
}
N_NIMCALL(NimStringDesc*, nospquoteShellWindows)(NimStringDesc* s) {
	NimStringDesc* result;
	NIM_BOOL needquote;
	NIM_BOOL LOC1;
	NimStringDesc* backslashbuff;
	NIM_CHAR c_145226;
	NI i_145228;
	nimfr("quoteShellWindows", "osproc.nim")
	result = 0;
	nimln(48, "osproc.nim");
	nimln(48, "osproc.nim");
	LOC1 = 0;
	nimln(730, "system.nim");
	LOC1 = contains_86683(s, TMP942);
	if (LOC1) goto LA2;
	nimln(48, "osproc.nim");
	nimln(48, "osproc.nim");
	LOC1 = (s->Sup.len == 0);
	LA2: ;
	needquote = LOC1;
	nimln(50, "osproc.nim");
	result = copyString(((NimStringDesc*) &TMP943));
	nimln(51, "osproc.nim");
	backslashbuff = copyString(((NimStringDesc*) &TMP943));
	nimln(52, "osproc.nim");
	{
		if (!needquote) goto LA5;
		nimln(53, "osproc.nim");
		result = resizeString(result, 1);
appendString(result, ((NimStringDesc*) &TMP944));
	}	LA5: ;
	c_145226 = 0;
	nimln(1400, "system.nim");
	i_145228 = 0;
	nimln(1401, "system.nim");
	while (1) {
		nimln(1401, "system.nim");
		nimln(1401, "system.nim");
		if (!(i_145228 < s->Sup.len)) goto LA7;
		nimln(1402, "system.nim");
		if ((NU)(i_145228) > (NU)(s->Sup.len)) raiseIndexError();
		c_145226 = s->data[i_145228];
		nimln(56, "osproc.nim");
		{
			nimln(56, "osproc.nim");
			if (!((NU8)(c_145226) == (NU8)(92))) goto LA10;
			nimln(57, "osproc.nim");
			backslashbuff = addChar(backslashbuff, c_145226);
		}		goto LA8;
		LA10: ;
		{
			nimln(58, "osproc.nim");
			if (!((NU8)(c_145226) == (NU8)(34))) goto LA13;
			nimln(59, "osproc.nim");
			result = resizeString(result, backslashbuff->Sup.len + 0);
appendString(result, backslashbuff);
			nimln(60, "osproc.nim");
			result = resizeString(result, backslashbuff->Sup.len + 0);
appendString(result, backslashbuff);
			nimln(61, "osproc.nim");
			backslashbuff = setLengthStr(backslashbuff, 0);
			nimln(62, "osproc.nim");
			result = resizeString(result, 2);
appendString(result, ((NimStringDesc*) &TMP945));
		}		goto LA8;
		LA13: ;
		{
			nimln(64, "osproc.nim");
			{
				nimln(698, "system.nim");
				nimln(698, "system.nim");
				nimln(64, "osproc.nim");
				if (!!((backslashbuff->Sup.len == 0))) goto LA18;
				nimln(65, "osproc.nim");
				result = resizeString(result, backslashbuff->Sup.len + 0);
appendString(result, backslashbuff);
				nimln(66, "osproc.nim");
				backslashbuff = setLengthStr(backslashbuff, 0);
			}			LA18: ;
			nimln(67, "osproc.nim");
			result = addChar(result, c_145226);
		}		LA8: ;
		nimln(1403, "system.nim");
		i_145228 = addInt(i_145228, 1);
	} LA7: ;
	nimln(69, "osproc.nim");
	{
		if (!needquote) goto LA22;
		nimln(70, "osproc.nim");
		result = resizeString(result, 1);
appendString(result, ((NimStringDesc*) &TMP944));
	}	LA22: ;
	popFrame();
	return result;
}
N_NIMCALL(NimStringDesc*, nospquoteShellPosix)(NimStringDesc* s) {
	NimStringDesc* result;
	NIM_BOOL safe;
	nimfr("quoteShellPosix", "osproc.nim")
	result = 0;
	nimln(77, "osproc.nim");
	{
		nimln(77, "osproc.nim");
		nimln(77, "osproc.nim");
		if (!(s->Sup.len == 0)) goto LA3;
		nimln(78, "osproc.nim");
		nimln(78, "osproc.nim");
		result = copyString(((NimStringDesc*) &TMP946));
		goto BeforeRet;
	}	LA3: ;
	nimln(80, "osproc.nim");
	safe = allcharsinset_86306(s, TMP947);
	nimln(82, "osproc.nim");
	{
		if (!safe) goto LA7;
		nimln(83, "osproc.nim");
		nimln(83, "osproc.nim");
		result = copyString(s);
		goto BeforeRet;
	}	goto LA5;
	LA7: ;
	{
		NimStringDesc* LOC10;
		NimStringDesc* LOC11;
		nimln(85, "osproc.nim");
		nimln(85, "osproc.nim");
		nimln(85, "osproc.nim");
		LOC10 = 0;
		nimln(85, "osproc.nim");
		LOC11 = 0;
		LOC11 = nsuReplaceStr(s, ((NimStringDesc*) &TMP948), ((NimStringDesc*) &TMP952));
		LOC10 = rawNewString(LOC11->Sup.len + 2);
appendString(LOC10, ((NimStringDesc*) &TMP948));
appendString(LOC10, LOC11);
appendString(LOC10, ((NimStringDesc*) &TMP948));
		result = LOC10;
		goto BeforeRet;
	}	LA5: ;
	BeforeRet: ;	popFrame();
	return result;
}
N_NIMCALL(NimStringDesc*, nospquoteShell)(NimStringDesc* s) {
	NimStringDesc* result;
	nimfr("quoteShell", "osproc.nim")
	result = 0;
	nimln(90, "osproc.nim");
	nimln(90, "osproc.nim");
	result = nospquoteShellWindows(s);
	goto BeforeRet;
	BeforeRet: ;	popFrame();
	return result;
}
static N_INLINE(NI, subInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU64)(a) - (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ (NI)((NU64) ~(b))));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}	LA5: ;
	raiseOverflow();	BeforeRet: ;	return result;
}
static N_INLINE(tcell38646*, usrtocell_42039)(void* usr) {
	tcell38646* result;
	nimfr("usrToCell", "gc.nim")
	result = 0;
	nimln(116, "gc.nim");
	nimln(116, "gc.nim");
	nimln(116, "gc.nim");
	result = ((tcell38646*) ((NI)((NU64)(((NI) (usr))) - (NU64)(((NI)sizeof(tcell38646))))));
	popFrame();
	return result;
}
static N_INLINE(void, rtladdzct_43602)(tcell38646* c) {
	nimfr("rtlAddZCT", "gc.nim")
	nimln(197, "gc.nim");
	addzct_42015(&gch_40644.Zct, c);	popFrame();
}
static N_INLINE(void, nimGCunrefNoCycle)(void* p) {
	tcell38646* c;
	nimfr("nimGCunrefNoCycle", "gc.nim")
	nimln(231, "gc.nim");
	c = usrtocell_42039(p);
	nimln(233, "gc.nim");
	{
		nimln(165, "gc.nim");
		(*c).Refcount -= 8;
		nimln(166, "gc.nim");
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		nimln(234, "gc.nim");
		rtladdzct_43602(c);	}	LA3: ;
	popFrame();
}
N_NIMCALL(tprocess145203*, startcmd_145428)(NimStringDesc* command, NU8 options) {
	tprocess145203* result;
	TY9552* c;
	TY9552* a;
	NI TMP958;
	NI i_145473;
	NI HEX3Atmp_145475;
	NI TMP959;
	NI res_145477;
	nimfr("startCmd", "osproc.nim")
	result = 0;
	nimln(135, "osproc.nim");
	c = nosparseCmdLine(command);
	a = 0;
	nimln(137, "osproc.nim");
	nimln(137, "osproc.nim");
	nimln(137, "osproc.nim");
	TMP958 = subInt(c->Sup.len, 1);
	a = (TY9552*) newSeq((&NTI9552), (NI64)(TMP958));
	i_145473 = 0;
	HEX3Atmp_145475 = 0;
	nimln(138, "osproc.nim");
	nimln(138, "osproc.nim");
	nimln(138, "osproc.nim");
	TMP959 = subInt(c->Sup.len, 1);
	HEX3Atmp_145475 = (NI64)(TMP959);
	nimln(1308, "system.nim");
	res_145477 = 1;
	nimln(1309, "system.nim");
	while (1) {
		NI TMP960;
		NimStringDesc* LOC2;
		nimln(1309, "system.nim");
		if (!(res_145477 <= HEX3Atmp_145475)) goto LA1;
		nimln(1308, "system.nim");
		i_145473 = res_145477;
		nimln(138, "osproc.nim");
		nimln(138, "osproc.nim");
		TMP960 = subInt(i_145473, 1);
		if ((NU)((NI64)(TMP960)) >= (NU)(a->Sup.len)) raiseIndexError();
		if ((NU)(i_145473) >= (NU)(c->Sup.len)) raiseIndexError();
		LOC2 = 0;
		LOC2 = a->data[(NI64)(TMP960)]; a->data[(NI64)(TMP960)] = copyStringRC1(c->data[i_145473]);
		if (LOC2) nimGCunrefNoCycle(LOC2);
		nimln(1311, "system.nim");
		res_145477 = addInt(res_145477, 1);
	} LA1: ;
	nimln(139, "osproc.nim");
	if ((NU)(0) >= (NU)(c->Sup.len)) raiseIndexError();
	result = nospstartProcess(c->data[0], ((NimStringDesc*) &TMP943), a->data, a->Sup.len, NIM_NIL, options);
	popFrame();
	return result;
}
N_NIMCALL(NI, nospprocessID)(tprocess145203* p) {
	NI result;
	nimfr("processID", "osproc.nim")
	result = 0;
	nimln(158, "osproc.nim");
	nimln(158, "osproc.nim");
	result = (*p).Id;
	goto BeforeRet;
	BeforeRet: ;	popFrame();
	return result;
}
N_NIMCALL(int, nospinputHandle)(tprocess145203* p) {
	int result;
	nimfr("inputHandle", "osproc.nim")
	result = 0;
	nimln(191, "osproc.nim");
	result = (*p).Inhandle;
	popFrame();
	return result;
}
N_NIMCALL(int, nospoutputHandle)(tprocess145203* p) {
	int result;
	nimfr("outputHandle", "osproc.nim")
	result = 0;
	nimln(199, "osproc.nim");
	result = (*p).Outhandle;
	popFrame();
	return result;
}
N_NIMCALL(int, nosperrorHandle)(tprocess145203* p) {
	int result;
	nimfr("errorHandle", "osproc.nim")
	result = 0;
	nimln(207, "osproc.nim");
	result = (*p).Errhandle;
	popFrame();
	return result;
}
N_NIMCALL(NI, nospcountProcessors)(void) {
	NI result;
	NimStringDesc* x;
	nimfr("countProcessors", "osproc.nim")
	result = 0;
	nimln(222, "osproc.nim");
	x = getenv_104824(((NimStringDesc*) &TMP961));
	nimln(223, "osproc.nim");
	{
		nimln(706, "system.nim");
		nimln(223, "osproc.nim");
		if (!(0 < x->Sup.len)) goto LA3;
		nimln(223, "osproc.nim");
		result = nsuParseInt(x);
	}	LA3: ;
	nimln(244, "osproc.nim");
	{
		nimln(244, "osproc.nim");
		if (!(result <= 0)) goto LA7;
		nimln(244, "osproc.nim");
		result = 1;
	}	LA7: ;
	popFrame();
	return result;
}N_NIMCALL(void, TMP971)(void* p, NI op) {
	tprocess145203* a;
	a = (tprocess145203*)p;
}
N_NIMCALL(void, TMP972)(void* p, NI op) {
	TY146202* a;
	NI LOC1;
	a = (TY146202*)p;
	LOC1 = 0;
	for (LOC1 = 0; LOC1 < a->Sup.len; LOC1++) {
	nimGCvisit((void*)a->data[LOC1], op);
	}
}

static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src) {
	nimfr("asgnRefNoCycle", "gc.nim")
	nimln(249, "gc.nim");
	{
		tcell38646* c;
		nimln(698, "system.nim");
		nimln(698, "system.nim");
		if (!!((src == NIM_NIL))) goto LA3;
		nimln(250, "gc.nim");
		c = usrtocell_42039(src);
		nimln(167, "gc.nim");
		(*c).Refcount += 8;
	}	LA3: ;
	nimln(252, "gc.nim");
	{
		tcell38646* c;
		nimln(698, "system.nim");
		nimln(698, "system.nim");
		if (!!(((*dest) == NIM_NIL))) goto LA7;
		nimln(253, "gc.nim");
		c = usrtocell_42039((*dest));
		nimln(254, "gc.nim");
		{
			nimln(165, "gc.nim");
			(*c).Refcount -= 8;
			nimln(166, "gc.nim");
			if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA11;
			nimln(255, "gc.nim");
			rtladdzct_43602(c);		}		LA11: ;
	}	LA7: ;
	nimln(256, "gc.nim");
	(*dest) = src;
	popFrame();
}
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** cmds, NI cmdsLen0, NU8 options, NI n) {
	NI result;
	nimfr("execProcesses", "osproc.nim")
	result = 0;
	nimln(257, "osproc.nim");
	{
		nimln(257, "osproc.nim");
		nimln(257, "osproc.nim");
		if (!!((0 < n))) goto LA3;
		nimln(257, "osproc.nim");
		hiddenraiseassert_77217(((NimStringDesc*) &TMP969));	}	LA3: ;
	nimln(258, "osproc.nim");
	{
		TY146202* q;
		NI m;
		NI i_146233;
		NI HEX3Atmp_146479;
		NI TMP973;
		NI res_146481;
		NI i;
		NI j_146448;
		NI HEX3Atmp_146487;
		NI TMP975;
		NI res_146489;
		nimln(706, "system.nim");
		if (!(1 < n)) goto LA7;
		q = 0;
		nimln(260, "osproc.nim");
		q = (TY146202*) newSeq((&NTI146202), n);
		nimln(261, "osproc.nim");
		nimln(261, "osproc.nim");
		nimln(261, "osproc.nim");
		m = ((n <= cmdsLen0) ? n : cmdsLen0);
		i_146233 = 0;
		HEX3Atmp_146479 = 0;
		nimln(262, "osproc.nim");
		nimln(262, "osproc.nim");
		TMP973 = subInt(m, 1);
		HEX3Atmp_146479 = (NI64)(TMP973);
		nimln(1308, "system.nim");
		res_146481 = 0;
		nimln(1309, "system.nim");
		while (1) {
			nimln(1309, "system.nim");
			if (!(res_146481 <= HEX3Atmp_146479)) goto LA9;
			nimln(1308, "system.nim");
			i_146233 = res_146481;
			nimln(263, "osproc.nim");
			if ((NU)(i_146233) >= (NU)(q->Sup.len)) raiseIndexError();
			if ((NU)(i_146233) >= (NU)(cmdsLen0)) raiseIndexError();
			asgnRefNoCycle((void**) &q->data[i_146233], startcmd_145428(cmds[i_146233], options));
			nimln(1311, "system.nim");
			res_146481 = addInt(res_146481, 1);
		} LA9: ;
		nimln(279, "osproc.nim");
		i = m;
		nimln(280, "osproc.nim");
		while (1) {
			NI r_146412;
			NI HEX3Atmp_146483;
			NI TMP974;
			NI res_146485;
			nimln(280, "osproc.nim");
			nimln(280, "osproc.nim");
			if (!(i <= (cmdsLen0-1))) goto LA10;
			nimln(281, "osproc.nim");
			nossleep(50);			r_146412 = 0;
			HEX3Atmp_146483 = 0;
			nimln(282, "osproc.nim");
			nimln(282, "osproc.nim");
			TMP974 = subInt(n, 1);
			HEX3Atmp_146483 = (NI64)(TMP974);
			nimln(1308, "system.nim");
			res_146485 = 0;
			nimln(1309, "system.nim");
			while (1) {
				nimln(1309, "system.nim");
				if (!(res_146485 <= HEX3Atmp_146483)) goto LA11;
				nimln(1308, "system.nim");
				r_146412 = res_146485;
				nimln(283, "osproc.nim");
				{
					NIM_BOOL LOC14;
					NI LOC17;
					nimln(283, "osproc.nim");
					nimln(283, "osproc.nim");
					if ((NU)(r_146412) >= (NU)(q->Sup.len)) raiseIndexError();
					LOC14 = 0;
					LOC14 = nosprunning(q->data[r_146412]);
					if (!!(LOC14)) goto LA15;
					nimln(285, "osproc.nim");
					nimln(285, "osproc.nim");
					nimln(285, "osproc.nim");
					if ((NU)(r_146412) >= (NU)(q->Sup.len)) raiseIndexError();
					LOC17 = 0;
					LOC17 = nospwaitForExit(q->data[r_146412], -1);
					result = ((LOC17 >= result) ? LOC17 : result);
					nimln(286, "osproc.nim");
					{
						nimln(698, "system.nim");
						nimln(698, "system.nim");
						if ((NU)(r_146412) >= (NU)(q->Sup.len)) raiseIndexError();
						if (!!((q->data[r_146412] == NIM_NIL))) goto LA20;
						nimln(286, "osproc.nim");
						if ((NU)(r_146412) >= (NU)(q->Sup.len)) raiseIndexError();
						nospclose(q->data[r_146412]);					}					LA20: ;
					nimln(287, "osproc.nim");
					if ((NU)(r_146412) >= (NU)(q->Sup.len)) raiseIndexError();
					if ((NU)(i) >= (NU)(cmdsLen0)) raiseIndexError();
					asgnRefNoCycle((void**) &q->data[r_146412], startcmd_145428(cmds[i], options));
					nimln(288, "osproc.nim");
					i = addInt(i, 1);
					nimln(289, "osproc.nim");
					{
						nimln(706, "system.nim");
						nimln(289, "osproc.nim");
						if (!((cmdsLen0-1) < i)) goto LA24;
						nimln(289, "osproc.nim");
						goto LA11;
					}					LA24: ;
				}				LA15: ;
				nimln(1311, "system.nim");
				res_146485 = addInt(res_146485, 1);
			} LA11: ;
		} LA10: ;
		j_146448 = 0;
		HEX3Atmp_146487 = 0;
		nimln(290, "osproc.nim");
		nimln(290, "osproc.nim");
		TMP975 = subInt(m, 1);
		HEX3Atmp_146487 = (NI64)(TMP975);
		nimln(1308, "system.nim");
		res_146489 = 0;
		nimln(1309, "system.nim");
		while (1) {
			NI LOC27;
			nimln(1309, "system.nim");
			if (!(res_146489 <= HEX3Atmp_146487)) goto LA26;
			nimln(1308, "system.nim");
			j_146448 = res_146489;
			nimln(291, "osproc.nim");
			nimln(291, "osproc.nim");
			nimln(291, "osproc.nim");
			if ((NU)(j_146448) >= (NU)(q->Sup.len)) raiseIndexError();
			LOC27 = 0;
			LOC27 = nospwaitForExit(q->data[j_146448], -1);
			result = ((LOC27 >= result) ? LOC27 : result);
			nimln(292, "osproc.nim");
			{
				nimln(698, "system.nim");
				nimln(698, "system.nim");
				if ((NU)(j_146448) >= (NU)(q->Sup.len)) raiseIndexError();
				if (!!((q->data[j_146448] == NIM_NIL))) goto LA30;
				nimln(292, "osproc.nim");
				if ((NU)(j_146448) >= (NU)(q->Sup.len)) raiseIndexError();
				nospclose(q->data[j_146448]);			}			LA30: ;
			nimln(1311, "system.nim");
			res_146489 = addInt(res_146489, 1);
		} LA26: ;
	}	goto LA5;
	LA7: ;
	{
		NI i_146473;
		NI HEX3Atmp_146491;
		NI res_146493;
		i_146473 = 0;
		HEX3Atmp_146491 = 0;
		nimln(294, "osproc.nim");
		nimln(294, "osproc.nim");
		HEX3Atmp_146491 = (cmdsLen0-1);
		nimln(1308, "system.nim");
		res_146493 = 0;
		nimln(1309, "system.nim");
		while (1) {
			tprocess145203* p;
			NI LOC34;
			nimln(1309, "system.nim");
			if (!(res_146493 <= HEX3Atmp_146491)) goto LA33;
			nimln(1308, "system.nim");
			i_146473 = res_146493;
			nimln(295, "osproc.nim");
			if ((NU)(i_146473) >= (NU)(cmdsLen0)) raiseIndexError();
			p = startcmd_145428(cmds[i_146473], options);
			nimln(296, "osproc.nim");
			nimln(296, "osproc.nim");
			nimln(296, "osproc.nim");
			LOC34 = 0;
			LOC34 = nospwaitForExit(p, -1);
			result = ((LOC34 >= result) ? LOC34 : result);
			nimln(297, "osproc.nim");
			nospclose(p);			nimln(1311, "system.nim");
			res_146493 = addInt(res_146493, 1);
		} LA33: ;
	}	LA5: ;
	popFrame();
	return result;
}
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* command, NU8 options) {
	NimStringDesc* result;
	tprocess145203* p;
	tstream143629* outp;
	NimStringDesc* line;
	nimfr("execProcess", "osproc.nim")
	result = 0;
	nimln(312, "osproc.nim");
	p = startcmd_145428(command, options);
	nimln(313, "osproc.nim");
	outp = nospoutputStream(p);
	nimln(314, "osproc.nim");
	result = copyString(((NimStringDesc*) &TMP976));
	nimln(315, "osproc.nim");
	nimln(315, "osproc.nim");
	line = rawNewString(120);
	nimln(316, "osproc.nim");
	while (1) {
		nimln(317, "osproc.nim");
		{
			NIM_BOOL LOC4;
			nimln(317, "osproc.nim");
			LOC4 = 0;
			LOC4 = readline_143973(outp, &line);
			if (!LOC4) goto LA5;
			nimln(318, "osproc.nim");
			result = resizeString(result, line->Sup.len + 0);
appendString(result, line);
			nimln(319, "osproc.nim");
			result = resizeString(result, 2);
appendString(result, ((NimStringDesc*) &TMP977));
		}		goto LA2;
		LA5: ;
		{
			NIM_BOOL LOC8;
			nimln(320, "osproc.nim");
			nimln(320, "osproc.nim");
			LOC8 = 0;
			LOC8 = nosprunning(p);
			if (!!(LOC8)) goto LA9;
			nimln(320, "osproc.nim");
			goto LA1;
		}		goto LA2;
		LA9: ;
		LA2: ;
	} LA1: ;
	nimln(321, "osproc.nim");
	nospclose(p);	popFrame();
	return result;
}
N_NIMCALL(void, hsclose_146608)(tstream143629* s) {
	nimfr("hsClose", "osproc.nim")
	popFrame();
}
N_NIMCALL(NIM_BOOL, hsatend_146612)(tstream143629* s) {
	NIM_BOOL result;
	nimfr("hsAtEnd", "osproc.nim")
	result = 0;
	nimln(333, "osproc.nim");
	nimln(333, "osproc.nim");
	if (s) chckObj((*s).Sup.m_type, (&NTI146605));
	result = (*((tfilehandlestream146605*) (s))).Attheend;
	goto BeforeRet;
	BeforeRet: ;	popFrame();
	return result;
}
static N_INLINE(NI, chckRange)(NI i, NI a, NI b) {
	NI result;
	result = 0;
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (a <= i);
		if (!(LOC3)) goto LA4;
		LOC3 = (i <= b);
		LA4: ;
		if (!LOC3) goto LA5;
		result = i;
		goto BeforeRet;
	}	goto LA1;
	LA5: ;
	{
		raiseRangeError(((NI64) (i)));	}	LA1: ;
	BeforeRet: ;	return result;
}
N_NIMCALL(NI, hsreaddata_146617)(tstream143629* s_146619, void* buffer, NI buflen) {
	NI result;
	tfilehandlestream146605* s;
	NI32 br;
	NI32 a;
	nimfr("hsReadData", "osproc.nim")
	result = 0;
	nimln(336, "osproc.nim");
	if (s_146619) chckObj((*s_146619).Sup.m_type, (&NTI146605));
	s = ((tfilehandlestream146605*) (s_146619));
	nimln(337, "osproc.nim");
	{
		if (!(*s).Attheend) goto LA3;
		nimln(337, "osproc.nim");
		nimln(337, "osproc.nim");
		result = 0;
		goto BeforeRet;
	}	LA3: ;
	br = 0;
	nimln(339, "osproc.nim");
	a = Dl_89824((*s).Handle, buffer, ((int)chckRange(buflen, ((int) (-2147483647 -1)), ((int) 2147483647))), &br, NIM_NIL);
	nimln(343, "osproc.nim");
	{
		NIM_BOOL LOC7;
		NI32 LOC11;
		nimln(343, "osproc.nim");
		LOC7 = 0;
		nimln(343, "osproc.nim");
		LOC7 = (a == ((NI32) 0));
		if (!(LOC7)) goto LA8;
		nimln(698, "system.nim");
		nimln(698, "system.nim");
		LOC7 = !((br == ((NI32) 0)));
		LA8: ;
		if (!LOC7) goto LA9;
		nimln(343, "osproc.nim");
		nimln(343, "osproc.nim");
		LOC11 = 0;
		LOC11 = oslasterror_97267();
		oserror_97226(LOC11);	}	LA9: ;
	nimln(344, "osproc.nim");
	nimln(344, "osproc.nim");
	(*s).Attheend = (((NI) (br)) < buflen);
	nimln(345, "osproc.nim");
	result = ((NI) (br));
	BeforeRet: ;	popFrame();
	return result;
}
N_NIMCALL(void, hswritedata_146630)(tstream143629* s_146632, void* buffer, NI buflen) {
	tfilehandlestream146605* s;
	NI32 byteswritten;
	NI32 a;
	nimfr("hsWriteData", "osproc.nim")
	nimln(348, "osproc.nim");
	if (s_146632) chckObj((*s_146632).Sup.m_type, (&NTI146605));
	s = ((tfilehandlestream146605*) (s_146632));
	byteswritten = 0;
	nimln(350, "osproc.nim");
	a = Dl_89833((*s).Handle, buffer, ((int)chckRange(buflen, ((int) (-2147483647 -1)), ((int) 2147483647))), &byteswritten, NIM_NIL);
	nimln(351, "osproc.nim");
	{
		NI32 LOC5;
		nimln(351, "osproc.nim");
		if (!(a == ((NI32) 0))) goto LA3;
		nimln(351, "osproc.nim");
		nimln(351, "osproc.nim");
		LOC5 = 0;
		LOC5 = oslasterror_97267();
		oserror_97226(LOC5);	}	LA3: ;
	popFrame();
}N_NIMCALL(void, TMP981)(void* p, NI op) {
	tfilehandlestream146605* a;
	a = (tfilehandlestream146605*)p;
}

N_NIMCALL(tfilehandlestream146605*, newfilehandlestream_146641)(NI handle) {
	tfilehandlestream146605* result;
	nimfr("newFileHandleStream", "osproc.nim")
	result = 0;
	nimln(354, "osproc.nim");
	result = (tfilehandlestream146605*) newObj((&NTI146603), sizeof(tfilehandlestream146605));
	(*result).Sup.Sup.m_type = (&NTI146605);
	nimln(355, "osproc.nim");
	(*result).Handle = handle;
	nimln(356, "osproc.nim");
	(*result).Sup.Closeimpl = hsclose_146608;
	nimln(357, "osproc.nim");
	(*result).Sup.Atendimpl = hsatend_146612;
	nimln(358, "osproc.nim");
	(*result).Sup.Readdataimpl = hsreaddata_146617;
	nimln(359, "osproc.nim");
	(*result).Sup.Writedataimpl = hswritedata_146630;
	popFrame();
	return result;
}
N_NIMCALL(NCSTRING, buildcommandline_146658)(NimStringDesc* a, NimStringDesc** args, NI argsLen0) {
	NCSTRING result;
	NimStringDesc* res;
	NI i_146674;
	NI HEX3Atmp_146675;
	NI res_146677;
	NI TMP982;
	void* LOC3;
	nimfr("buildCommandLine", "osproc.nim")
	result = 0;
	nimln(362, "osproc.nim");
	res = nospquoteShell(a);
	i_146674 = 0;
	HEX3Atmp_146675 = 0;
	nimln(363, "osproc.nim");
	nimln(363, "osproc.nim");
	HEX3Atmp_146675 = (argsLen0-1);
	nimln(1308, "system.nim");
	res_146677 = 0;
	nimln(1309, "system.nim");
	while (1) {
		NimStringDesc* LOC2;
		nimln(1309, "system.nim");
		if (!(res_146677 <= HEX3Atmp_146675)) goto LA1;
		nimln(1308, "system.nim");
		i_146674 = res_146677;
		nimln(364, "osproc.nim");
		res = addChar(res, 32);
		nimln(365, "osproc.nim");
		nimln(365, "osproc.nim");
		if ((NU)(i_146674) >= (NU)(argsLen0)) raiseIndexError();
		LOC2 = 0;
		LOC2 = nospquoteShell(args[i_146674]);
		res = resizeString(res, LOC2->Sup.len + 0);
appendString(res, LOC2);
		nimln(1311, "system.nim");
		res_146677 = addInt(res_146677, 1);
	} LA1: ;
	nimln(366, "osproc.nim");
	nimln(366, "osproc.nim");
	nimln(366, "osproc.nim");
	nimln(366, "osproc.nim");
	TMP982 = addInt(res->Sup.len, 1);
	LOC3 = 0;
	LOC3 = alloc0_4004((NI64)(TMP982));
	result = ((NCSTRING) (LOC3));
	nimln(367, "osproc.nim");
	nimln(367, "osproc.nim");
	memcpy(((void*) (result)), ((void*) (res->data)), res->Sup.len);	popFrame();
	return result;
}
N_NIMCALL(NCSTRING, buildenv_146682)(tstringtable113610* env) {
	NCSTRING result;
	NI l;
	NimStringDesc* key_146687;
	NimStringDesc* val_146688;
	NI h_146714;
	NI HEX3Atmp_146716;
	NI res_146718;
	NI TMP985;
	void* LOC6;
	NimStringDesc* key_146699;
	NimStringDesc* val_146700;
	NI h_146721;
	NI HEX3Atmp_146723;
	NI res_146725;
	nimfr("buildEnv", "osproc.nim")
	result = 0;
	nimln(370, "osproc.nim");
	l = 0;
	key_146687 = 0;
	val_146688 = 0;
	h_146714 = 0;
	HEX3Atmp_146716 = 0;
	nimln(40, "strtabs.nim");
	nimln(40, "strtabs.nim");
	HEX3Atmp_146716 = ((*env).Data->Sup.len-1);
	nimln(1308, "system.nim");
	res_146718 = 0;
	nimln(1309, "system.nim");
	while (1) {
		nimln(1309, "system.nim");
		if (!(res_146718 <= HEX3Atmp_146716)) goto LA1;
		nimln(1308, "system.nim");
		h_146714 = res_146718;
		nimln(41, "strtabs.nim");
		{
			NI TMP983;
			NI TMP984;
			nimln(41, "strtabs.nim");
			nimln(41, "strtabs.nim");
			if ((NU)(h_146714) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			if (!!((*env).Data->data[h_146714].Field0 == 0)) goto LA4;
			nimln(42, "strtabs.nim");
			if ((NU)(h_146714) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			key_146687 = (*env).Data->data[h_146714].Field0;
			nimln(42, "strtabs.nim");
			if ((NU)(h_146714) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			val_146688 = (*env).Data->data[h_146714].Field1;
			nimln(371, "osproc.nim");
			nimln(371, "osproc.nim");
			nimln(371, "osproc.nim");
			nimln(371, "osproc.nim");
			nimln(371, "osproc.nim");
			TMP983 = addInt(key_146687->Sup.len, val_146688->Sup.len);
			TMP984 = addInt((NI64)(TMP983), 2);
			l = addInt(l, (NI64)(TMP984));
		}		LA4: ;
		nimln(1311, "system.nim");
		res_146718 = addInt(res_146718, 1);
	} LA1: ;
	nimln(372, "osproc.nim");
	nimln(372, "osproc.nim");
	nimln(372, "osproc.nim");
	TMP985 = addInt(l, 2);
	LOC6 = 0;
	LOC6 = alloc0_4004((NI64)(TMP985));
	result = ((NCSTRING) (LOC6));
	nimln(373, "osproc.nim");
	l = 0;
	key_146699 = 0;
	val_146700 = 0;
	h_146721 = 0;
	HEX3Atmp_146723 = 0;
	nimln(40, "strtabs.nim");
	nimln(40, "strtabs.nim");
	HEX3Atmp_146723 = ((*env).Data->Sup.len-1);
	nimln(1308, "system.nim");
	res_146725 = 0;
	nimln(1309, "system.nim");
	while (1) {
		nimln(1309, "system.nim");
		if (!(res_146725 <= HEX3Atmp_146723)) goto LA7;
		nimln(1308, "system.nim");
		h_146721 = res_146725;
		nimln(41, "strtabs.nim");
		{
			NimStringDesc* x;
			NimStringDesc* LOC12;
			NI TMP987;
			NI TMP988;
			nimln(41, "strtabs.nim");
			nimln(41, "strtabs.nim");
			if ((NU)(h_146721) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			if (!!((*env).Data->data[h_146721].Field0 == 0)) goto LA10;
			nimln(42, "strtabs.nim");
			if ((NU)(h_146721) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			key_146699 = (*env).Data->data[h_146721].Field0;
			nimln(42, "strtabs.nim");
			if ((NU)(h_146721) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			val_146700 = (*env).Data->data[h_146721].Field1;
			nimln(375, "osproc.nim");
			nimln(375, "osproc.nim");
			LOC12 = 0;
			LOC12 = rawNewString(key_146699->Sup.len + val_146700->Sup.len + 1);
appendString(LOC12, key_146699);
appendString(LOC12, ((NimStringDesc*) &TMP986));
appendString(LOC12, val_146700);
			x = LOC12;
			nimln(376, "osproc.nim");
			nimln(376, "osproc.nim");
			nimln(376, "osproc.nim");
			TMP987 = addInt(x->Sup.len, 1);
			memcpy(((void*) (&result[l])), ((void*) (x->data)), (NI64)(TMP987));			nimln(377, "osproc.nim");
			nimln(377, "osproc.nim");
			nimln(377, "osproc.nim");
			TMP988 = addInt(x->Sup.len, 1);
			l = addInt(l, (NI64)(TMP988));
		}		LA10: ;
		nimln(1311, "system.nim");
		res_146725 = addInt(res_146725, 1);
	} LA7: ;
	popFrame();
	return result;
}
N_NIMCALL(void, createpipehandles_146729)(NI* rdhandle, NI* wrhandle) {
	tsecurityattributes89653 piinheritablepipe;
	nimfr("CreatePipeHandles", "osproc.nim")
	memset((void*)&piinheritablepipe, 0, sizeof(piinheritablepipe));
	nimln(388, "osproc.nim");
	nimln(388, "osproc.nim");
	piinheritablepipe.Nlength = ((int)chckRange(((NI)sizeof(tsecurityattributes89653)), ((int) (-2147483647 -1)), ((int) 2147483647)));
	nimln(389, "osproc.nim");
	piinheritablepipe.Lpsecuritydescriptor = NIM_NIL;
	nimln(390, "osproc.nim");
	piinheritablepipe.Binherithandle = ((NI32) 1);
	nimln(391, "osproc.nim");
	{
		NI32 LOC3;
		NI32 LOC6;
		nimln(391, "osproc.nim");
		nimln(391, "osproc.nim");
		LOC3 = 0;
		LOC3 = Dl_89842(rdhandle, wrhandle, &piinheritablepipe, ((NI32) 1024));
		if (!(LOC3 == ((NI32) 0))) goto LA4;
		nimln(392, "osproc.nim");
		nimln(392, "osproc.nim");
		LOC6 = 0;
		LOC6 = oslasterror_97267();
		oserror_97226(LOC6);	}	LA4: ;
	popFrame();
}
static N_INLINE(void, fileclose_146742)(NI h) {
	nimfr("fileClose", "osproc.nim")
	nimln(395, "osproc.nim");
	{
		NI32 LOC5;
		nimln(706, "system.nim");
		if (!(4 < h)) goto LA3;
		nimln(395, "osproc.nim");
		nimln(395, "osproc.nim");
		LOC5 = 0;
		LOC5 = Dl_89820(h);
	}	LA3: ;
	popFrame();
}
N_NIMCALL(tprocess145203*, nospstartProcess)(NimStringDesc* command, NimStringDesc* workingdir, NimStringDesc** args, NI argsLen0, tstringtable113610* env, NU8 options) {
	tprocess145203* result;
	tstartupinfo89655 si;
	tprocessinformation89657 procinfo;
	NI success;
	NI hi;
	NI ho;
	NI he;
	NCSTRING cmdl;
	NCSTRING wd;
	NCSTRING e;
	NI16* tmp;
	NI16* ee;
	NI16* wwd;
	NI32 LOC24;
	NI32 lasterror;
	NI32 LOC41;
	nimfr("startProcess", "osproc.nim")
	result = 0;
	memset((void*)&si, 0, sizeof(si));
	memset((void*)&procinfo, 0, sizeof(procinfo));
	success = 0;
	hi = 0;
	ho = 0;
	he = 0;
	nimln(407, "osproc.nim");
	result = (tprocess145203*) newObj((&NTI145205), sizeof(tprocess145203));
	(*result).Sup.m_type = (&NTI145203);
	nimln(408, "osproc.nim");
	nimln(408, "osproc.nim");
	si.Cb = ((int)chckRange(((NI)sizeof(tstartupinfo89655)), ((int) (-2147483647 -1)), ((int) 2147483647)));
	nimln(409, "osproc.nim");
	{
		nimln(731, "system.nim");
		nimln(731, "system.nim");
		if (!!(((options &(1<<((((NU8) 3))&7)))!=0))) goto LA3;
		nimln(410, "osproc.nim");
		si.Dwflags = ((NI32) 256);
		nimln(411, "osproc.nim");
		createpipehandles_146729(&si.Hstdinput, &hi);		nimln(412, "osproc.nim");
		createpipehandles_146729(&ho, &si.Hstdoutput);		nimln(413, "osproc.nim");
		{
			nimln(730, "system.nim");
			if (!((options &(1<<((((NU8) 2))&7)))!=0)) goto LA7;
			nimln(414, "osproc.nim");
			si.Hstderror = si.Hstdoutput;
			nimln(415, "osproc.nim");
			he = ho;
		}		goto LA5;
		LA7: ;
		{
			nimln(417, "osproc.nim");
			createpipehandles_146729(&he, &si.Hstderror);		}		LA5: ;
		nimln(418, "osproc.nim");
		(*result).Inhandle = ((int)chckRange(hi, ((int) (-2147483647 -1)), ((int) 2147483647)));
		nimln(419, "osproc.nim");
		(*result).Outhandle = ((int)chckRange(ho, ((int) (-2147483647 -1)), ((int) 2147483647)));
		nimln(420, "osproc.nim");
		(*result).Errhandle = ((int)chckRange(he, ((int) (-2147483647 -1)), ((int) 2147483647)));
	}	goto LA1;
	LA3: ;
	{
		nimln(422, "osproc.nim");
		si.Hstderror = Dl_90026(((NI32) -12));
		nimln(423, "osproc.nim");
		si.Hstdinput = Dl_90026(((NI32) -10));
		nimln(424, "osproc.nim");
		si.Hstdoutput = Dl_90026(((NI32) -11));
		nimln(425, "osproc.nim");
		(*result).Inhandle = ((int)chckRange(si.Hstdinput, ((int) (-2147483647 -1)), ((int) 2147483647)));
		nimln(426, "osproc.nim");
		(*result).Outhandle = ((int)chckRange(si.Hstdoutput, ((int) (-2147483647 -1)), ((int) 2147483647)));
		nimln(427, "osproc.nim");
		(*result).Errhandle = ((int)chckRange(si.Hstderror, ((int) (-2147483647 -1)), ((int) 2147483647)));
	}	LA1: ;
	cmdl = 0;
	nimln(433, "osproc.nim");
	cmdl = buildcommandline_146658(command, args, argsLen0);
	nimln(434, "osproc.nim");
	wd = NIM_NIL;
	nimln(435, "osproc.nim");
	e = NIM_NIL;
	nimln(436, "osproc.nim");
	{
		nimln(706, "system.nim");
		nimln(436, "osproc.nim");
		if (!(0 < workingdir->Sup.len)) goto LA13;
		nimln(436, "osproc.nim");
		wd = workingdir->data;
	}	LA13: ;
	nimln(437, "osproc.nim");
	{
		nimln(698, "system.nim");
		nimln(698, "system.nim");
		if (!!((env == NIM_NIL))) goto LA17;
		nimln(437, "osproc.nim");
		e = buildenv_146682(env);
	}	LA17: ;
	nimln(438, "osproc.nim");
	{
		NimStringDesc* LOC23;
		nimln(730, "system.nim");
		if (!((options &(1<<((((NU8) 0))&7)))!=0)) goto LA21;
		nimln(438, "osproc.nim");
		nimln(438, "osproc.nim");
		LOC23 = 0;
		LOC23 = cstrToNimstr(cmdl);
		printf("%s\015\012", (LOC23)->data);
	}	LA21: ;
	nimln(440, "osproc.nim");
	tmp = newwidecstring_70519(cmdl);
	nimln(441, "osproc.nim");
	ee = newwidecstring_70519(e);
	nimln(442, "osproc.nim");
	wwd = newwidecstring_70519(wd);
	nimln(443, "osproc.nim");
	nimln(443, "osproc.nim");
	LOC24 = 0;
	LOC24 = Dl_89851(NIM_NIL, tmp, NIM_NIL, NIM_NIL, ((NI32) 1), ((NI32) 1056), ee, wwd, &si, &procinfo);
	success = ((NI) (LOC24));
	nimln(449, "osproc.nim");
	lasterror = oslasterror_97267();
	nimln(451, "osproc.nim");
	{
		nimln(731, "system.nim");
		nimln(731, "system.nim");
		if (!!(((options &(1<<((((NU8) 3))&7)))!=0))) goto LA27;
		nimln(452, "osproc.nim");
		fileclose_146742(si.Hstdinput);		nimln(453, "osproc.nim");
		fileclose_146742(si.Hstdoutput);		nimln(454, "osproc.nim");
		{
			nimln(731, "system.nim");
			nimln(731, "system.nim");
			if (!!(((options &(1<<((((NU8) 2))&7)))!=0))) goto LA31;
			nimln(455, "osproc.nim");
			fileclose_146742(si.Hstderror);		}		LA31: ;
	}	LA27: ;
	nimln(457, "osproc.nim");
	{
		nimln(698, "system.nim");
		nimln(698, "system.nim");
		if (!!((e == NIM_NIL))) goto LA35;
		nimln(457, "osproc.nim");
		dealloc_4011(((void*) (e)));	}	LA35: ;
	nimln(458, "osproc.nim");
	dealloc_4011(((void*) (cmdl)));	nimln(459, "osproc.nim");
	{
		nimln(459, "osproc.nim");
		if (!(success == 0)) goto LA39;
		nimln(459, "osproc.nim");
		oserror_97226(lasterror);	}	LA39: ;
	nimln(461, "osproc.nim");
	nimln(461, "osproc.nim");
	LOC41 = 0;
	LOC41 = Dl_89820(procinfo.Hthread);
	nimln(462, "osproc.nim");
	(*result).Fprocesshandle = procinfo.Hprocess;
	nimln(463, "osproc.nim");
	(*result).Id = ((NI) (procinfo.Dwprocessid));
	popFrame();
	return result;
}
N_NIMCALL(void, nospsuspend)(tprocess145203* p) {
	NI32 LOC1;
	nimfr("suspend", "osproc.nim")
	nimln(474, "osproc.nim");
	nimln(474, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_90002((*p).Fprocesshandle);
	popFrame();
}
N_NIMCALL(void, nospresume)(tprocess145203* p) {
	NI32 LOC1;
	nimfr("resume", "osproc.nim")
	nimln(477, "osproc.nim");
	nimln(477, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_90006((*p).Fprocesshandle);
	popFrame();
}
N_NIMCALL(NIM_BOOL, nosprunning)(tprocess145203* p) {
	NIM_BOOL result;
	NI32 x;
	nimfr("running", "osproc.nim")
	result = 0;
	nimln(480, "osproc.nim");
	x = Dl_90010((*p).Fprocesshandle, ((NI32) 50));
	nimln(481, "osproc.nim");
	nimln(481, "osproc.nim");
	nimln(481, "osproc.nim");
	result = (x == ((NI32) 258));
	goto BeforeRet;
	BeforeRet: ;	popFrame();
	return result;
}
N_NIMCALL(void, nospterminate)(tprocess145203* p) {
	nimfr("terminate", "osproc.nim")
	nimln(484, "osproc.nim");
	{
		NIM_BOOL LOC3;
		NI32 LOC6;
		nimln(484, "osproc.nim");
		LOC3 = 0;
		LOC3 = nosprunning(p);
		if (!LOC3) goto LA4;
		nimln(485, "osproc.nim");
		nimln(485, "osproc.nim");
		LOC6 = 0;
		LOC6 = Dl_90015((*p).Fprocesshandle, 0);
	}	LA4: ;
	popFrame();
}
N_NIMCALL(NI, nospwaitForExit)(tprocess145203* p, NI timeout) {
	NI result;
	NI32 LOC1;
	NI32 res;
	NI32 LOC2;
	NI32 LOC3;
	nimfr("waitForExit", "osproc.nim")
	result = 0;
	nimln(488, "osproc.nim");
	nimln(488, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_90010((*p).Fprocesshandle, ((NI32)chckRange(timeout, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))));
	res = 0;
	nimln(491, "osproc.nim");
	nimln(491, "osproc.nim");
	LOC2 = 0;
	LOC2 = Dl_90020((*p).Fprocesshandle, &res);
	nimln(492, "osproc.nim");
	result = ((NI) (res));
	nimln(493, "osproc.nim");
	nimln(493, "osproc.nim");
	LOC3 = 0;
	LOC3 = Dl_89820((*p).Fprocesshandle);
	popFrame();
	return result;
}
N_NIMCALL(NI, peekexitcode_145513)(tprocess145203* p) {
	NI result;
	NIM_BOOL b;
	NI32 LOC1;
	nimfr("peekExitCode", "osproc.nim")
	result = 0;
	nimln(496, "osproc.nim");
	nimln(496, "osproc.nim");
	nimln(496, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_90010((*p).Fprocesshandle, ((NI32) 50));
	b = (LOC1 == ((NI32) 258));
	nimln(497, "osproc.nim");
	{
		if (!b) goto LA4;
		nimln(497, "osproc.nim");
		result = -1;
	}	goto LA2;
	LA4: ;
	{
		NI32 res;
		NI32 LOC7;
		res = 0;
		nimln(500, "osproc.nim");
		nimln(500, "osproc.nim");
		LOC7 = 0;
		LOC7 = Dl_90020((*p).Fprocesshandle, &res);
		nimln(501, "osproc.nim");
		nimln(501, "osproc.nim");
		result = ((NI) (res));
		goto BeforeRet;
	}	LA2: ;
	BeforeRet: ;	popFrame();
	return result;
}
N_NIMCALL(tstream143629*, nospinputStream)(tprocess145203* p) {
	tstream143629* result;
	tfilehandlestream146605* LOC1;
	nimfr("inputStream", "osproc.nim")
	result = 0;
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	LOC1 = 0;
	LOC1 = newfilehandlestream_146641(((NI) ((*p).Inhandle)));
	result = &LOC1->Sup;
	popFrame();
	return result;
}
N_NIMCALL(tstream143629*, nospoutputStream)(tprocess145203* p) {
	tstream143629* result;
	tfilehandlestream146605* LOC1;
	nimfr("outputStream", "osproc.nim")
	result = 0;
	nimln(507, "osproc.nim");
	nimln(507, "osproc.nim");
	LOC1 = 0;
	LOC1 = newfilehandlestream_146641(((NI) ((*p).Outhandle)));
	result = &LOC1->Sup;
	popFrame();
	return result;
}
N_NIMCALL(tstream143629*, nosperrorStream)(tprocess145203* p) {
	tstream143629* result;
	tfilehandlestream146605* LOC1;
	nimfr("errorStream", "osproc.nim")
	result = 0;
	nimln(510, "osproc.nim");
	nimln(510, "osproc.nim");
	LOC1 = 0;
	LOC1 = newfilehandlestream_146641(((NI) ((*p).Errhandle)));
	result = &LOC1->Sup;
	popFrame();
	return result;
}
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* command) {
	NI result;
	tstartupinfo89655 si;
	tprocessinformation89657 procinfo;
	NI process;
	NI32 l;
	NI16* c;
	NI32 res;
	nimfr("execCmd", "osproc.nim")
	result = 0;
	memset((void*)&si, 0, sizeof(si));
	memset((void*)&procinfo, 0, sizeof(procinfo));
	process = 0;
	l = 0;
	nimln(518, "osproc.nim");
	nimln(518, "osproc.nim");
	si.Cb = ((int)chckRange(((NI)sizeof(tstartupinfo89655)), ((int) (-2147483647 -1)), ((int) 2147483647)));
	nimln(519, "osproc.nim");
	si.Hstderror = Dl_90026(((NI32) -12));
	nimln(520, "osproc.nim");
	si.Hstdinput = Dl_90026(((NI32) -10));
	nimln(521, "osproc.nim");
	si.Hstdoutput = Dl_90026(((NI32) -11));
	nimln(523, "osproc.nim");
	c = newwidecstring_70603(command);
	nimln(524, "osproc.nim");
	res = Dl_89851(NIM_NIL, c, NIM_NIL, NIM_NIL, ((NI32) 0), ((NI32) 32), NIM_NIL, NIM_NIL, &si, &procinfo);
	nimln(529, "osproc.nim");
	{
		NI32 LOC5;
		nimln(529, "osproc.nim");
		if (!(res == ((NI32) 0))) goto LA3;
		nimln(530, "osproc.nim");
		nimln(530, "osproc.nim");
		LOC5 = 0;
		LOC5 = oslasterror_97267();
		oserror_97226(LOC5);	}	goto LA1;
	LA3: ;
	{
		NI32 LOC7;
		NI32 LOC15;
		nimln(532, "osproc.nim");
		process = procinfo.Hprocess;
		nimln(533, "osproc.nim");
		nimln(533, "osproc.nim");
		LOC7 = 0;
		LOC7 = Dl_89820(procinfo.Hthread);
		nimln(534, "osproc.nim");
		{
			NI32 LOC10;
			NI32 LOC13;
			nimln(698, "system.nim");
			nimln(698, "system.nim");
			nimln(534, "osproc.nim");
			LOC10 = 0;
			LOC10 = Dl_90010(process, ((NI32) -1));
			if (!!((LOC10 == ((NI32) -1)))) goto LA11;
			nimln(535, "osproc.nim");
			nimln(535, "osproc.nim");
			LOC13 = 0;
			LOC13 = Dl_90020(process, &l);
			nimln(536, "osproc.nim");
			result = ((NI) (l));
		}		goto LA8;
		LA11: ;
		{
			nimln(538, "osproc.nim");
			result = -1;
		}		LA8: ;
		nimln(539, "osproc.nim");
		nimln(539, "osproc.nim");
		LOC15 = 0;
		LOC15 = Dl_89820(process);
	}	LA1: ;
	popFrame();
	return result;
}
N_NIMCALL(NI, select_146502)(TY146202** readfds, NI timeout) {
	NI result;
	twohandlearray91373 rfds;
	NI i_147819;
	NI HEX3Atmp_147862;
	NI TMP990;
	NI res_147864;
	NI32 ret;
	nimfr("select", "osproc.nim")
	result = 0;
	nimln(542, "osproc.nim");
	{
		nimln(542, "osproc.nim");
		nimln(542, "osproc.nim");
		nimln(542, "osproc.nim");
		if (!!(((*readfds)->Sup.len <= 64))) goto LA3;
		nimln(542, "osproc.nim");
		hiddenraiseassert_77217(((NimStringDesc*) &TMP989));	}	LA3: ;
	memset((void*)rfds, 0, sizeof(rfds));
	i_147819 = 0;
	HEX3Atmp_147862 = 0;
	nimln(544, "osproc.nim");
	nimln(544, "osproc.nim");
	nimln(544, "osproc.nim");
	TMP990 = subInt((*readfds)->Sup.len, 1);
	HEX3Atmp_147862 = (NI64)(TMP990);
	nimln(1308, "system.nim");
	res_147864 = 0;
	nimln(1309, "system.nim");
	while (1) {
		nimln(1309, "system.nim");
		if (!(res_147864 <= HEX3Atmp_147862)) goto LA5;
		nimln(1308, "system.nim");
		i_147819 = res_147864;
		nimln(545, "osproc.nim");
		if ((NU)(i_147819) > (NU)(63)) raiseIndexError();
		if ((NU)(i_147819) >= (NU)((*readfds)->Sup.len)) raiseIndexError();
		rfds[(i_147819)- 0] = (*(*readfds)->data[i_147819]).Fprocesshandle;
		nimln(1311, "system.nim");
		res_147864 = addInt(res_147864, 1);
	} LA5: ;
	nimln(547, "osproc.nim");
	nimln(547, "osproc.nim");
	ret = Dl_91378(((NI32)chckRange((*readfds)->Sup.len, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))), rfds, ((NI32) 0), ((NI32)chckRange(timeout, ((NI32) (-2147483647 -1)), ((NI32) 2147483647))));
	nimln(549, "osproc.nim");
	switch (ret) {
	case ((NI32) 258):
	{
		nimln(551, "osproc.nim");
		nimln(551, "osproc.nim");
		result = 0;
		goto BeforeRet;
	}	break;
	case ((NI32) -1):
	{
		NI32 LOC8;
		nimln(553, "osproc.nim");
		nimln(553, "osproc.nim");
		LOC8 = 0;
		LOC8 = oslasterror_97267();
		oserror_97226(LOC8);	}	break;
	default:
	{
		NI32 i;
		NI TMP991;
		nimln(555, "osproc.nim");
		nimln(555, "osproc.nim");
		TMP991 = subInt(ret, ((NI32) 0));
		if (TMP991 < (-2147483647 -1) || TMP991 > 2147483647) raiseOverflow();
		i = (NI32)(TMP991);
		nimln(556, "osproc.nim");
		del_147834(readfds, ((NI) (i)));		nimln(557, "osproc.nim");
		nimln(557, "osproc.nim");
		result = 1;
		goto BeforeRet;
	}	break;
	}
	BeforeRet: ;	popFrame();
	return result;
}
N_NIMCALL(void, nospclose)(tprocess145203* p) {
	nimfr("close", "osproc.nim")
	popFrame();
}
N_NIMCALL(void, execcmdex_148002)(NimStringDesc* command, NU8 options, TY77088* Result) {
	tprocess145203* p;
	tstream143629* outp;
	NimStringDesc* line;
	nimfr("execCmdEx", "osproc.nim")
	nimln(833, "osproc.nim");
	p = startcmd_145428(command, options);
	nimln(834, "osproc.nim");
	outp = nospoutputStream(p);
	nimln(835, "osproc.nim");
	unsureAsgnRef((void**) &(*Result).Field0, copyString(TMP992.Field0));
	(*Result).Field1 = TMP992.Field1;
	nimln(836, "osproc.nim");
	nimln(836, "osproc.nim");
	line = rawNewString(120);
	nimln(837, "osproc.nim");
	while (1) {
		nimln(838, "osproc.nim");
		{
			NIM_BOOL LOC4;
			nimln(838, "osproc.nim");
			LOC4 = 0;
			LOC4 = readline_143973(outp, &line);
			if (!LOC4) goto LA5;
			nimln(839, "osproc.nim");
			(*Result).Field0 = resizeString((*Result).Field0, line->Sup.len + 0);
appendString((*Result).Field0, line);
			nimln(840, "osproc.nim");
			(*Result).Field0 = resizeString((*Result).Field0, 2);
appendString((*Result).Field0, ((NimStringDesc*) &TMP977));
		}		goto LA2;
		LA5: ;
		{
			nimln(842, "osproc.nim");
			(*Result).Field1 = peekexitcode_145513(p);
			nimln(843, "osproc.nim");
			{
				nimln(698, "system.nim");
				nimln(698, "system.nim");
				if (!!(((*Result).Field1 == -1))) goto LA10;
				nimln(843, "osproc.nim");
				goto LA1;
			}			LA10: ;
		}		LA2: ;
	} LA1: ;
	nimln(844, "osproc.nim");
	nospclose(p);	popFrame();
}N_NOINLINE(void, pureosprocInit)(void) {
	nimfr("osproc", "osproc.nim")
	popFrame();
}

N_NOINLINE(void, pureosprocDatInit)(void) {
static TNimNode* TMP970[6];
static TNimNode* TMP980[2];
static TNimNode TMP928[10];
NTI145203.size = sizeof(tprocess145203);
NTI145203.kind = 17;
NTI145203.base = (&NTI1009);
NTI145203.flags = 3;
TMP970[0] = &TMP928[1];
TMP928[1].kind = 1;
TMP928[1].offset = offsetof(tprocess145203, Fprocesshandle);
TMP928[1].typ = (&NTI89641);
TMP928[1].name = "FProcessHandle";
TMP970[1] = &TMP928[2];
TMP928[2].kind = 1;
TMP928[2].offset = offsetof(tprocess145203, Inhandle);
TMP928[2].typ = (&NTI9008);
TMP928[2].name = "inHandle";
TMP970[2] = &TMP928[3];
TMP928[3].kind = 1;
TMP928[3].offset = offsetof(tprocess145203, Outhandle);
TMP928[3].typ = (&NTI9008);
TMP928[3].name = "outHandle";
TMP970[3] = &TMP928[4];
TMP928[4].kind = 1;
TMP928[4].offset = offsetof(tprocess145203, Errhandle);
TMP928[4].typ = (&NTI9008);
TMP928[4].name = "errHandle";
TMP970[4] = &TMP928[5];
TMP928[5].kind = 1;
TMP928[5].offset = offsetof(tprocess145203, Id);
TMP928[5].typ = (&NTI89641);
TMP928[5].name = "id";
TMP970[5] = &TMP928[6];
TMP928[6].kind = 1;
TMP928[6].offset = offsetof(tprocess145203, Exitcode);
TMP928[6].typ = (&NTI3809);
TMP928[6].name = "exitCode";
TMP928[0].len = 6; TMP928[0].kind = 2; TMP928[0].sons = &TMP970[0];
NTI145203.node = &TMP928[0];
NTI145205.size = sizeof(tprocess145203*);
NTI145205.kind = 22;
NTI145205.base = (&NTI145203);
NTI145205.flags = 2;
NTI145205.marker = TMP971;
NTI146202.size = sizeof(TY146202*);
NTI146202.kind = 24;
NTI146202.base = (&NTI145205);
NTI146202.flags = 2;
NTI146202.marker = TMP972;
NTI146605.size = sizeof(tfilehandlestream146605);
NTI146605.kind = 17;
NTI146605.base = (&NTI143629);
NTI146605.flags = 3;
TMP980[0] = &TMP928[8];
TMP928[8].kind = 1;
TMP928[8].offset = offsetof(tfilehandlestream146605, Handle);
TMP928[8].typ = (&NTI89641);
TMP928[8].name = "handle";
TMP980[1] = &TMP928[9];
TMP928[9].kind = 1;
TMP928[9].offset = offsetof(tfilehandlestream146605, Attheend);
TMP928[9].typ = (&NTI133);
TMP928[9].name = "atTheEnd";
TMP928[7].len = 2; TMP928[7].kind = 2; TMP928[7].sons = &TMP980[0];
NTI146605.node = &TMP928[7];
NTI146603.size = sizeof(tfilehandlestream146605*);
NTI146603.kind = 22;
NTI146603.base = (&NTI146605);
NTI146603.flags = 2;
NTI146603.marker = TMP981;
}

