/* Generated by Nimrod Compiler v0.9.3 */
/*   (c) 2012 Andreas Rumpf */
/* The generated code is subject to the original license. */
#define NIM_INTBITS 32
#include "nimbase.h"

#include <sys/types.h>

#include <unistd.h>

#include <string.h>

#include <spawn.h>

#include <signal.h>

#include <sys/wait.h>

#include <sys/select.h>

#include <stdio.h>
typedef struct tprocess135203 tprocess135203;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct TY9355 TY9355;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct tcell38846 tcell38846;
typedef struct tcellseq38862 tcellseq38862;
typedef struct tgcheap40816 tgcheap40816;
typedef struct tcellset38858 tcellset38858;
typedef struct tpagedesc38854 tpagedesc38854;
typedef struct tmemregion22410 tmemregion22410;
typedef struct tsmallchunk21643 tsmallchunk21643;
typedef struct tllchunk22404 tllchunk22404;
typedef struct tbigchunk21645 tbigchunk21645;
typedef struct tintset21618 tintset21618;
typedef struct ttrunk21614 ttrunk21614;
typedef struct tavlnode22408 tavlnode22408;
typedef struct tgcstat40814 tgcstat40814;
typedef struct TNimObject TNimObject;
typedef struct tstream133630 tstream133630;
typedef struct TY136003 TY136003;
typedef struct tstringtable103609 tstringtable103609;
typedef struct tkeyvaluepairseq103607 tkeyvaluepairseq103607;
typedef struct TY81913 TY81913;
typedef struct tfilestream134125 tfilestream134125;
typedef struct TY71482 TY71482;
typedef struct tbasechunk21641 tbasechunk21641;
typedef struct tfreecell21633 tfreecell21633;
struct TGenericSeq {
NI len;
NI reserved;
};
typedef NIM_CHAR TY611[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY611 data;
};
typedef N_NIMCALL_PTR(void, TY891) (void* p, NI op);
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY891 marker;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct tcell38846 {
NI Refcount;
TNimType* Typ;
};
struct tcellseq38862 {
NI Len;
NI Cap;
tcell38846** D;
};
struct tcellset38858 {
NI Counter;
NI Max;
tpagedesc38854* Head;
tpagedesc38854** Data;
};
typedef tsmallchunk21643* TY22422[512];
typedef ttrunk21614* ttrunkbuckets21616[256];
struct tintset21618 {
ttrunkbuckets21616 Data;
};
struct tmemregion22410 {
NI Minlargeobj;
NI Maxlargeobj;
TY22422 Freesmallchunks;
tllchunk22404* Llmem;
NI Currmem;
NI Maxmem;
NI Freemem;
NI Lastsize;
tbigchunk21645* Freechunkslist;
tintset21618 Chunkstarts;
tavlnode22408* Root;
tavlnode22408* Deleted;
tavlnode22408* Last;
tavlnode22408* Freeavlnodes;
};
struct tgcstat40814 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
NI64 Maxpause;
};
struct tgcheap40816 {
void* Stackbottom;
NI Cyclethreshold;
tcellseq38862 Zct;
tcellseq38862 Decstack;
tcellset38858 Cycleroots;
tcellseq38862 Tempstack;
NI Recgclock;
tmemregion22410 Region;
tgcstat40814 Stat;
};
struct TNimObject {
TNimType* m_type;
};
struct tprocess135203 {
  TNimObject Sup;
int Inputhandle;
int Outputhandle;
int Errorhandle;
tstream133630* Instream;
tstream133630* Outstream;
tstream133630* Errstream;
pid_t Id;
int Exitcode;
};
struct TY81913 {
NimStringDesc* Field0;
NimStringDesc* Field1;
};
struct tstringtable103609 {
  TNimObject Sup;
NI Counter;
tkeyvaluepairseq103607* Data;
NU8 Mode;
};
typedef int TY136594[2];
typedef NimStringDesc* TY105474[1];
typedef NimStringDesc* TY105434[2];
struct TY71482 {
NimStringDesc* Field0;
NI Field1;
};
typedef NI TY21621[16];
struct tpagedesc38854 {
tpagedesc38854* Next;
NI Key;
TY21621 Bits;
};
struct tbasechunk21641 {
NI Prevsize;
NI Size;
NIM_BOOL Used;
};
struct tsmallchunk21643 {
  tbasechunk21641 Sup;
tsmallchunk21643* Next;
tsmallchunk21643* Prev;
tfreecell21633* Freelist;
NI Free;
NI Acc;
NF64 Data;
};
struct tllchunk22404 {
NI Size;
NI Acc;
tllchunk22404* Next;
};
struct tbigchunk21645 {
  tbasechunk21641 Sup;
tbigchunk21645* Next;
tbigchunk21645* Prev;
NI Align;
NF64 Data;
};
struct ttrunk21614 {
ttrunk21614* Next;
NI Key;
TY21621 Bits;
};
typedef tavlnode22408* TY22414[2];
struct tavlnode22408 {
TY22414 Link;
NI Key;
NI Upperbound;
NI Level;
};
typedef N_NIMCALL_PTR(void, TY133631) (tstream133630* s);
typedef N_NIMCALL_PTR(NIM_BOOL, TY133635) (tstream133630* s);
typedef N_NIMCALL_PTR(void, TY133639) (tstream133630* s, NI pos);
typedef N_NIMCALL_PTR(NI, TY133644) (tstream133630* s);
typedef N_NIMCALL_PTR(NI, TY133648) (tstream133630* s, void* buffer, NI buflen);
typedef N_NIMCALL_PTR(void, TY133654) (tstream133630* s, void* buffer, NI buflen);
typedef N_NIMCALL_PTR(void, TY133660) (tstream133630* s);
struct tstream133630 {
  TNimObject Sup;
TY133631 Closeimpl;
TY133635 Atendimpl;
TY133639 Setpositionimpl;
TY133644 Getpositionimpl;
TY133648 Readdataimpl;
TY133654 Writedataimpl;
TY133660 Flushimpl;
};
struct tfilestream134125 {
  tstream133630 Sup;
FILE* F;
};
struct tfreecell21633 {
tfreecell21633* Next;
NI Zerofield;
};
struct TY9355 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
struct TY136003 {
  TGenericSeq Sup;
  tprocess135203* data[SEQ_DECL_SIZE];
};
struct tkeyvaluepairseq103607 {
  TGenericSeq Sup;
  TY81913 data[SEQ_DECL_SIZE];
};
N_NIMCALL(tprocess135203*, startcmd_135246)(NimStringDesc* command, NU8 options);
N_NIMCALL(TY9355*, nosparseCmdLine)(NimStringDesc* c);
static N_INLINE(NI, subInt)(NI a, NI b);
N_NOINLINE(void, raiseOverflow)(void);
N_NIMCALL(void*, newSeq)(TNimType* typ, NI len);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(NimStringDesc*, copyStringRC1)(NimStringDesc* src);
static N_INLINE(void, nimGCunrefNoCycle)(void* p);
static N_INLINE(tcell38846*, usrtocell_42243)(void* usr);
static N_INLINE(void, nimFrame)(TFrame* s);
static N_INLINE(void, popFrame)(void);
static N_INLINE(void, rtladdzct_43402)(tcell38846* c);
N_NOINLINE(void, addzct_42215)(tcellseq38862* s, tcell38846* c);
static N_INLINE(NI, addInt)(NI a, NI b);
N_NIMCALL(NI, nospprocessID)(tprocess135203* p);
N_NIMCALL(NI, nospcountProcessors)(void);
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** cmds, NI cmdsLen0, NU8 options_135608, NI n);
N_NIMCALL(void, hiddenraiseassert_71620)(NimStringDesc* msg);
N_NIMCALL(void, nimGCvisit)(void* d, NI op);
N_NIMCALL(void, TMP903)(void* p, NI op);
N_NIMCALL(void, TMP904)(void* p, NI op);
static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src);
N_NIMCALL(void, nossleep)(NI milsecs);
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* command, NU8 options);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
N_NIMCALL(NimStringDesc*, rawNewString)(NI cap);
N_NIMCALL(NIM_BOOL, readline_133979)(tstream133630* s, NimStringDesc** line);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* dest, NI addlen);
N_NIMCALL(NimStringDesc*, addcmdargs_136404)(NimStringDesc* command, NimStringDesc** args, NI argsLen0);
N_NIMCALL(NimStringDesc*, quoteifcontainswhite_78720)(NimStringDesc* s);
N_NIMCALL(NCSTRING*, tocstringarray_136424)(NimStringDesc** b, NI bLen0, NimStringDesc** a, NI aLen0);
N_NOCONV(void*, alloc0_4004)(NI size);
N_NIMCALL(NI, mulInt)(NI a, NI b);
N_NOCONV(void*, alloc_4001)(NI size);
N_NIMCALL(NCSTRING*, tocstringarray_136482)(tstringtable103609* t);
N_NIMCALL(NI, nstlen)(tstringtable103609* t);
N_NIMCALL(NCSTRING*, envtocstringarray_136515)(void);
N_NIMCALL(void, getenvvarsc_95402)(void);
N_NIMCALL(NI, nsuFindChar)(NimStringDesc* s, NIM_CHAR sub, NI start);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* s, NI start_63824, NI last);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* s, NI first, NI last);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* s, NI start);
N_NIMCALL(NimStringDesc*, copyStr)(NimStringDesc* s, NI first);
N_NIMCALL(tprocess135203*, nospstartProcess)(NimStringDesc* command, NimStringDesc* workingdir, NimStringDesc** args, NI argsLen0, tstringtable103609* env, NU8 options);
N_NIMCALL(void*, newObj)(TNimType* typ, NI size);
N_NIMCALL(void, oserror_92005)(NI32 errorcode);
N_NIMCALL(NI32, oslasterror_92052)(void);
static N_INLINE(void, setcurrentdir_93803)(NimStringDesc* newdir);
N_NIMCALL(NimStringDesc*, nosextractFilename)(NimStringDesc* path);
N_NIMCALL(void, dealloccstringarray_9637)(NCSTRING* a);
N_NIMCALL(NimStringDesc*, nsuJoinSep)(NimStringDesc** a, NI aLen0, NimStringDesc* sep);
N_NIMCALL(void, nospclose)(tprocess135203* p);
N_NIMCALL(void, close_133675)(tstream133630* s);
N_NIMCALL(void, nospsuspend)(tprocess135203* p);
N_NIMCALL(void, nospresume)(tprocess135203* p);
N_NIMCALL(NIM_BOOL, nosprunning)(tprocess135203* p);
N_NIMCALL(void, nospterminate)(tprocess135203* p);
N_NIMCALL(NI, nospwaitForExit)(tprocess135203* p, NI timeout);
N_NIMCALL(NI, peekexitcode_135331)(tprocess135203* p);
N_NIMCALL(void, createstream_137009)(tstream133630** stream, NI32* handle, NU8 filemode);
N_NIMCALL(NIM_BOOL, open_9026)(FILE** f, int filehandle, NU8 mode);
N_NIMCALL(tfilestream134125*, newfilestream_134182)(FILE* f);
N_NIMCALL(void, unsureAsgnRef)(void** dest, void* src);
N_NIMCALL(tstream133630*, nospinputStream)(tprocess135203* p);
N_NIMCALL(tstream133630*, nospoutputStream)(tprocess135203* p);
N_NIMCALL(tstream133630*, nosperrorStream)(tprocess135203* p);
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* command);
N_NIMCALL(void, createfdset_137082)(fd_set* fd, TY136003* s, NI* m);
N_NIMCALL(void, pruneprocessset_137136)(TY136003** s, fd_set* fd);
N_NIMCALL(TGenericSeq*, setLengthSeq)(TGenericSeq* seq, NI elemsize, NI newlen);
N_NIMCALL(NI, select_136301)(TY136003** readfds, NI timeout);
N_NIMCALL(void, execcmdex_137402)(NimStringDesc* command, NU8 options, TY71482* Result);
STRING_LITERAL(TMP899, "", 0);
STRING_LITERAL(TMP900, "0 < n ", 6);
STRING_LITERAL(TMP912, "", 0);
STRING_LITERAL(TMP913, "\012", 1);
STRING_LITERAL(TMP915, " ", 1);
STRING_LITERAL(TMP927, "=", 1);
STRING_LITERAL(TMP939, "sh", 2);
STRING_LITERAL(TMP940, "-c", 2);
NIM_CONST TY105434 TMP938 = {((NimStringDesc*) &TMP939),
((NimStringDesc*) &TMP940)}
;
NIM_CONST TY71482 TMP948 = {((NimStringDesc*) &TMP912),
-1}
;
extern TNimType NTI9355; /* seq[string] */
extern TFrame* frameptr_12027;
extern tgcheap40816 gch_40842;
extern TNimType NTI1009; /* TObject */
TNimType NTI135203; /* TProcess */
extern TNimType NTI9008; /* TFileHandle */
extern TNimType NTI133628; /* PStream */
extern TNimType NTI84455; /* TPid */
extern TNimType NTI3701; /* cint */
TNimType NTI135205; /* PProcess */
TNimType NTI136003; /* seq[PProcess] */
extern TY9355* environment_95235;

static N_INLINE(NI, subInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU32)(a) - (NU32)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ (NI)((NU32) ~(b))));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

static N_INLINE(void, nimFrame)(TFrame* s) {
	(*s).prev = frameptr_12027;
	frameptr_12027 = s;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_12027 = (*frameptr_12027).prev;
}

static N_INLINE(tcell38846*, usrtocell_42243)(void* usr) {
	tcell38846* result;
	nimfr("usrToCell", "gc.nim")
	result = 0;
	nimln(106, "gc.nim");
	nimln(106, "gc.nim");
	nimln(106, "gc.nim");
	result = ((tcell38846*) ((NI)((NU32)(((NI) (usr))) - (NU32)(((NI)sizeof(tcell38846))))));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdzct_43402)(tcell38846* c) {
	nimfr("rtlAddZCT", "gc.nim")
	nimln(184, "gc.nim");
	addzct_42215(&gch_40842.Zct, c);
	popFrame();
}

static N_INLINE(void, nimGCunrefNoCycle)(void* p) {
	tcell38846* c;
	nimfr("nimGCunrefNoCycle", "gc.nim")
	nimln(218, "gc.nim");
	c = usrtocell_42243(p);
	nimln(220, "gc.nim");
	{
		nimln(155, "gc.nim");
		(*c).Refcount -= 8;
		nimln(156, "gc.nim");
		if (!((NU32)((*c).Refcount) < (NU32)(8))) goto LA3;
		nimln(221, "gc.nim");
		rtladdzct_43402(c);
	}
	LA3: ;
	popFrame();
}

static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU32)(a) + (NU32)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

N_NIMCALL(tprocess135203*, startcmd_135246)(NimStringDesc* command, NU8 options) {
	tprocess135203* result;
	TY9355* c;
	TY9355* a;
	NI TMP896;
	NI i_135291;
	NI HEX3Atmp_135293;
	NI TMP897;
	NI res_135295;
	nimfr("startCmd", "osproc.nim")
	result = 0;
	nimln(83, "osproc.nim");
	c = nosparseCmdLine(command);
	a = 0;
	nimln(85, "osproc.nim");
	nimln(85, "osproc.nim");
	nimln(85, "osproc.nim");
	TMP896 = subInt(c->Sup.len, 1);
	a = (TY9355*) newSeq((&NTI9355), (NI32)(TMP896));
	i_135291 = 0;
	HEX3Atmp_135293 = 0;
	nimln(86, "osproc.nim");
	nimln(86, "osproc.nim");
	nimln(86, "osproc.nim");
	TMP897 = subInt(c->Sup.len, 1);
	HEX3Atmp_135293 = (NI32)(TMP897);
	nimln(1281, "system.nim");
	res_135295 = 1;
	nimln(1282, "system.nim");
	while (1) {
		NI TMP898;
		NimStringDesc* LOC2;
		nimln(1282, "system.nim");
		if (!(res_135295 <= HEX3Atmp_135293)) goto LA1;
		nimln(1281, "system.nim");
		i_135291 = res_135295;
		nimln(86, "osproc.nim");
		nimln(86, "osproc.nim");
		TMP898 = subInt(i_135291, 1);
		if ((NU)((NI32)(TMP898)) >= (NU)(a->Sup.len)) raiseIndexError();
		if ((NU)(i_135291) >= (NU)(c->Sup.len)) raiseIndexError();
		LOC2 = 0;
		LOC2 = a->data[(NI32)(TMP898)]; a->data[(NI32)(TMP898)] = copyStringRC1(c->data[i_135291]);
		if (LOC2) nimGCunrefNoCycle(LOC2);
		nimln(1284, "system.nim");
		res_135295 = addInt(res_135295, 1);
	} LA1: ;
	nimln(87, "osproc.nim");
	if ((NU)(0) >= (NU)(c->Sup.len)) raiseIndexError();
	result = nospstartProcess(c->data[0], ((NimStringDesc*) &TMP899), a->data, a->Sup.len, NIM_NIL, options);
	popFrame();
	return result;
}

N_NIMCALL(NI, nospprocessID)(tprocess135203* p) {
	NI result;
	nimfr("processID", "osproc.nim")
	result = 0;
	nimln(106, "osproc.nim");
	nimln(106, "osproc.nim");
	result = (*p).Id;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(NI, nospcountProcessors)(void) {
	NI result;
	nimfr("countProcessors", "osproc.nim")
	result = 0;
	nimln(167, "osproc.nim");
	result = sysconf(_SC_NPROCESSORS_ONLN);
	nimln(168, "osproc.nim");
	{
		nimln(168, "osproc.nim");
		if (!(result <= 0)) goto LA3;
		nimln(168, "osproc.nim");
		result = 1;
	}
	LA3: ;
	popFrame();
	return result;
}
N_NIMCALL(void, TMP903)(void* p, NI op) {
	tprocess135203* a;
	a = (tprocess135203*)p;
	nimGCvisit((void*)(*a).Instream, op);
	nimGCvisit((void*)(*a).Outstream, op);
	nimGCvisit((void*)(*a).Errstream, op);
}
N_NIMCALL(void, TMP904)(void* p, NI op) {
	TY136003* a;
	NI LOC1;
	a = (TY136003*)p;
	for (LOC1 = 0; LOC1 < a->Sup.len; LOC1++) {
	nimGCvisit((void*)a->data[LOC1], op);
	}
}

static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src) {
	nimfr("asgnRefNoCycle", "gc.nim")
	nimln(236, "gc.nim");
	{
		tcell38846* c;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!((src == NIM_NIL))) goto LA3;
		nimln(237, "gc.nim");
		c = usrtocell_42243(src);
		nimln(157, "gc.nim");
		(*c).Refcount += 8;
	}
	LA3: ;
	nimln(239, "gc.nim");
	{
		tcell38846* c;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!(((*dest) == NIM_NIL))) goto LA7;
		nimln(240, "gc.nim");
		c = usrtocell_42243((*dest));
		nimln(241, "gc.nim");
		{
			nimln(155, "gc.nim");
			(*c).Refcount -= 8;
			nimln(156, "gc.nim");
			if (!((NU32)((*c).Refcount) < (NU32)(8))) goto LA11;
			nimln(242, "gc.nim");
			rtladdzct_43402(c);
		}
		LA11: ;
	}
	LA7: ;
	nimln(243, "gc.nim");
	(*dest) = src;
	popFrame();
}

N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** cmds, NI cmdsLen0, NU8 options_135608, NI n) {
	NI result;
	NU8 options;
	nimfr("execProcesses", "osproc.nim")
	result = 0;
	nimln(179, "osproc.nim");
	nimln(179, "osproc.nim");
	options = (options_135608 & ~ 8);
	nimln(181, "osproc.nim");
	{
		nimln(181, "osproc.nim");
		nimln(181, "osproc.nim");
		if (!!((0 < n))) goto LA3;
		nimln(181, "osproc.nim");
		hiddenraiseassert_71620(((NimStringDesc*) &TMP900));
	}
	LA3: ;
	nimln(182, "osproc.nim");
	{
		TY136003* q;
		NI m;
		NI i_136034;
		NI HEX3Atmp_136278;
		NI TMP905;
		NI res_136280;
		NI i;
		NI j_136248;
		NI HEX3Atmp_136286;
		NI TMP911;
		NI res_136288;
		nimln(692, "system.nim");
		if (!(1 < n)) goto LA7;
		q = 0;
		nimln(184, "osproc.nim");
		q = (TY136003*) newSeq((&NTI136003), n);
		nimln(185, "osproc.nim");
		nimln(185, "osproc.nim");
		nimln(185, "osproc.nim");
		m = ((n <= cmdsLen0) ? n : cmdsLen0);
		i_136034 = 0;
		HEX3Atmp_136278 = 0;
		nimln(186, "osproc.nim");
		nimln(186, "osproc.nim");
		TMP905 = subInt(m, 1);
		HEX3Atmp_136278 = (NI32)(TMP905);
		nimln(1281, "system.nim");
		res_136280 = 0;
		nimln(1282, "system.nim");
		while (1) {
			nimln(1282, "system.nim");
			if (!(res_136280 <= HEX3Atmp_136278)) goto LA9;
			nimln(1281, "system.nim");
			i_136034 = res_136280;
			nimln(187, "osproc.nim");
			if ((NU)(i_136034) >= (NU)(q->Sup.len)) raiseIndexError();
			if ((NU)(i_136034) >= (NU)(cmdsLen0)) raiseIndexError();
			asgnRefNoCycle((void**) &q->data[i_136034], startcmd_135246(cmds[i_136034], options));
			nimln(1284, "system.nim");
			res_136280 = addInt(res_136280, 1);
		} LA9: ;
		nimln(203, "osproc.nim");
		i = m;
		nimln(204, "osproc.nim");
		while (1) {
			NI r_136211;
			NI HEX3Atmp_136282;
			NI TMP910;
			NI res_136284;
			nimln(204, "osproc.nim");
			nimln(204, "osproc.nim");
			if (!(i <= (cmdsLen0-1))) goto LA10;
			nimln(205, "osproc.nim");
			nossleep(50);
			r_136211 = 0;
			HEX3Atmp_136282 = 0;
			nimln(206, "osproc.nim");
			nimln(206, "osproc.nim");
			TMP910 = subInt(n, 1);
			HEX3Atmp_136282 = (NI32)(TMP910);
			nimln(1281, "system.nim");
			res_136284 = 0;
			nimln(1282, "system.nim");
			while (1) {
				nimln(1282, "system.nim");
				if (!(res_136284 <= HEX3Atmp_136282)) goto LA11;
				nimln(1281, "system.nim");
				r_136211 = res_136284;
				nimln(207, "osproc.nim");
				{
					NIM_BOOL LOC14;
					NI LOC17;
					nimln(207, "osproc.nim");
					nimln(207, "osproc.nim");
					if ((NU)(r_136211) >= (NU)(q->Sup.len)) raiseIndexError();
					LOC14 = nosprunning(q->data[r_136211]);
					if (!!(LOC14)) goto LA15;
					nimln(209, "osproc.nim");
					nimln(209, "osproc.nim");
					nimln(209, "osproc.nim");
					if ((NU)(r_136211) >= (NU)(q->Sup.len)) raiseIndexError();
					LOC17 = nospwaitForExit(q->data[r_136211], -1);
					result = ((LOC17 >= result) ? LOC17 : result);
					nimln(210, "osproc.nim");
					{
						nimln(684, "system.nim");
						nimln(684, "system.nim");
						if ((NU)(r_136211) >= (NU)(q->Sup.len)) raiseIndexError();
						if (!!((q->data[r_136211] == NIM_NIL))) goto LA20;
						nimln(210, "osproc.nim");
						if ((NU)(r_136211) >= (NU)(q->Sup.len)) raiseIndexError();
						nospclose(q->data[r_136211]);
					}
					LA20: ;
					nimln(211, "osproc.nim");
					if ((NU)(r_136211) >= (NU)(q->Sup.len)) raiseIndexError();
					if ((NU)(i) >= (NU)(cmdsLen0)) raiseIndexError();
					asgnRefNoCycle((void**) &q->data[r_136211], startcmd_135246(cmds[i], options));
					nimln(212, "osproc.nim");
					i = addInt(i, 1);
					nimln(213, "osproc.nim");
					{
						nimln(692, "system.nim");
						nimln(213, "osproc.nim");
						if (!((cmdsLen0-1) < i)) goto LA24;
						nimln(213, "osproc.nim");
						goto LA11;
					}
					LA24: ;
				}
				LA15: ;
				nimln(1284, "system.nim");
				res_136284 = addInt(res_136284, 1);
			} LA11: ;
		} LA10: ;
		j_136248 = 0;
		HEX3Atmp_136286 = 0;
		nimln(214, "osproc.nim");
		nimln(214, "osproc.nim");
		TMP911 = subInt(m, 1);
		HEX3Atmp_136286 = (NI32)(TMP911);
		nimln(1281, "system.nim");
		res_136288 = 0;
		nimln(1282, "system.nim");
		while (1) {
			NI LOC31;
			nimln(1282, "system.nim");
			if (!(res_136288 <= HEX3Atmp_136286)) goto LA26;
			nimln(1281, "system.nim");
			j_136248 = res_136288;
			nimln(215, "osproc.nim");
			{
				nimln(684, "system.nim");
				nimln(684, "system.nim");
				if ((NU)(j_136248) >= (NU)(q->Sup.len)) raiseIndexError();
				if (!!((q->data[j_136248] == NIM_NIL))) goto LA29;
				nimln(215, "osproc.nim");
				if ((NU)(j_136248) >= (NU)(q->Sup.len)) raiseIndexError();
				nospclose(q->data[j_136248]);
			}
			LA29: ;
			nimln(216, "osproc.nim");
			nimln(216, "osproc.nim");
			nimln(216, "osproc.nim");
			if ((NU)(j_136248) >= (NU)(q->Sup.len)) raiseIndexError();
			LOC31 = nospwaitForExit(q->data[j_136248], -1);
			result = ((LOC31 >= result) ? LOC31 : result);
			nimln(1284, "system.nim");
			res_136288 = addInt(res_136288, 1);
		} LA26: ;
	}
	goto LA5;
	LA7: ;
	{
		NI i_136271;
		NI HEX3Atmp_136290;
		NI res_136292;
		i_136271 = 0;
		HEX3Atmp_136290 = 0;
		nimln(218, "osproc.nim");
		nimln(218, "osproc.nim");
		HEX3Atmp_136290 = (cmdsLen0-1);
		nimln(1281, "system.nim");
		res_136292 = 0;
		nimln(1282, "system.nim");
		while (1) {
			tprocess135203* p;
			NI LOC34;
			nimln(1282, "system.nim");
			if (!(res_136292 <= HEX3Atmp_136290)) goto LA33;
			nimln(1281, "system.nim");
			i_136271 = res_136292;
			nimln(219, "osproc.nim");
			if ((NU)(i_136271) >= (NU)(cmdsLen0)) raiseIndexError();
			p = startcmd_135246(cmds[i_136271], options);
			nimln(220, "osproc.nim");
			nimln(220, "osproc.nim");
			nimln(220, "osproc.nim");
			LOC34 = nospwaitForExit(p, -1);
			result = ((LOC34 >= result) ? LOC34 : result);
			nimln(221, "osproc.nim");
			nospclose(p);
			nimln(1284, "system.nim");
			res_136292 = addInt(res_136292, 1);
		} LA33: ;
	}
	LA5: ;
	popFrame();
	return result;
}

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	memcpy(((NCSTRING) (&(*dest).data[((*dest).Sup.len)- 0])), ((NCSTRING) ((*src).data)), (NI32)((*src).Sup.len + 1));
	(*dest).Sup.len += (*src).Sup.len;
}

N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* command, NU8 options) {
	NimStringDesc* result;
	tprocess135203* p;
	tstream133630* outp;
	NimStringDesc* line;
	nimfr("execProcess", "osproc.nim")
	result = 0;
	nimln(236, "osproc.nim");
	p = startcmd_135246(command, options);
	nimln(237, "osproc.nim");
	outp = nospoutputStream(p);
	nimln(238, "osproc.nim");
	result = copyString(((NimStringDesc*) &TMP912));
	nimln(239, "osproc.nim");
	nimln(239, "osproc.nim");
	line = rawNewString(120);
	nimln(240, "osproc.nim");
	while (1) {
		nimln(241, "osproc.nim");
		{
			NIM_BOOL LOC4;
			nimln(241, "osproc.nim");
			LOC4 = readline_133979(outp, &line);
			if (!LOC4) goto LA5;
			nimln(242, "osproc.nim");
			result = resizeString(result, line->Sup.len + 0);
appendString(result, line);
			nimln(243, "osproc.nim");
			result = resizeString(result, 1);
appendString(result, ((NimStringDesc*) &TMP913));
		}
		goto LA2;
		LA5: ;
		{
			NIM_BOOL LOC8;
			nimln(244, "osproc.nim");
			nimln(244, "osproc.nim");
			LOC8 = nosprunning(p);
			if (!!(LOC8)) goto LA9;
			nimln(244, "osproc.nim");
			goto LA1;
		}
		goto LA2;
		LA9: ;
		LA2: ;
	} LA1: ;
	nimln(245, "osproc.nim");
	nospclose(p);
	popFrame();
	return result;
}

N_NIMCALL(NimStringDesc*, addcmdargs_136404)(NimStringDesc* command, NimStringDesc** args, NI argsLen0) {
	NimStringDesc* result;
	NI i_136417;
	NI HEX3Atmp_136418;
	NI res_136420;
	nimfr("addCmdArgs", "osproc.nim")
	result = 0;
	nimln(489, "osproc.nim");
	result = quoteifcontainswhite_78720(command);
	i_136417 = 0;
	HEX3Atmp_136418 = 0;
	nimln(490, "osproc.nim");
	nimln(490, "osproc.nim");
	HEX3Atmp_136418 = (argsLen0-1);
	nimln(1281, "system.nim");
	res_136420 = 0;
	nimln(1282, "system.nim");
	while (1) {
		NimStringDesc* LOC2;
		nimln(1282, "system.nim");
		if (!(res_136420 <= HEX3Atmp_136418)) goto LA1;
		nimln(1281, "system.nim");
		i_136417 = res_136420;
		nimln(491, "osproc.nim");
		result = resizeString(result, 1);
appendString(result, ((NimStringDesc*) &TMP915));
		nimln(492, "osproc.nim");
		nimln(492, "osproc.nim");
		if ((NU)(i_136417) >= (NU)(argsLen0)) raiseIndexError();
		LOC2 = 0;
		LOC2 = quoteifcontainswhite_78720(args[i_136417]);
		result = resizeString(result, LOC2->Sup.len + 0);
appendString(result, LOC2);
		nimln(1284, "system.nim");
		res_136420 = addInt(res_136420, 1);
	} LA1: ;
	popFrame();
	return result;
}

N_NIMCALL(NCSTRING*, tocstringarray_136424)(NimStringDesc** b, NI bLen0, NimStringDesc** a, NI aLen0) {
	NCSTRING* result;
	NI TMP916;
	NI TMP917;
	NI TMP918;
	void* LOC1;
	NI i_136448;
	NI HEX3Atmp_136470;
	NI res_136472;
	NI i_136456;
	NI HEX3Atmp_136475;
	NI res_136477;
	nimfr("toCStringArray", "osproc.nim")
	result = 0;
	nimln(495, "osproc.nim");
	nimln(495, "osproc.nim");
	nimln(495, "osproc.nim");
	nimln(495, "osproc.nim");
	nimln(495, "osproc.nim");
	nimln(495, "osproc.nim");
	nimln(495, "osproc.nim");
	TMP916 = addInt(aLen0, bLen0);
	TMP917 = addInt((NI32)(TMP916), 1);
	TMP918 = mulInt((NI32)(TMP917), 4);
	LOC1 = alloc0_4004((NI32)(TMP918));
	result = ((NCSTRING*) (LOC1));
	i_136448 = 0;
	HEX3Atmp_136470 = 0;
	nimln(496, "osproc.nim");
	nimln(496, "osproc.nim");
	HEX3Atmp_136470 = (bLen0-1);
	nimln(1281, "system.nim");
	res_136472 = 0;
	nimln(1282, "system.nim");
	while (1) {
		NI TMP919;
		void* LOC3;
		NI TMP920;
		nimln(1282, "system.nim");
		if (!(res_136472 <= HEX3Atmp_136470)) goto LA2;
		nimln(1281, "system.nim");
		i_136448 = res_136472;
		nimln(497, "osproc.nim");
		if ((NU)(i_136448) > (NU)(50000)) raiseIndexError();
		nimln(497, "osproc.nim");
		nimln(497, "osproc.nim");
		nimln(497, "osproc.nim");
		if ((NU)(i_136448) >= (NU)(bLen0)) raiseIndexError();
		TMP919 = addInt(b[i_136448]->Sup.len, 1);
		LOC3 = alloc_4001((NI32)(TMP919));
		result[(i_136448)- 0] = ((NCSTRING) (LOC3));
		nimln(498, "osproc.nim");
		if ((NU)(i_136448) > (NU)(50000)) raiseIndexError();
		if ((NU)(i_136448) >= (NU)(bLen0)) raiseIndexError();
		nimln(498, "osproc.nim");
		nimln(498, "osproc.nim");
		if ((NU)(i_136448) >= (NU)(bLen0)) raiseIndexError();
		TMP920 = addInt(b[i_136448]->Sup.len, 1);
		memcpy(((void*) (result[(i_136448)- 0])), ((void*) (b[i_136448]->data)), (NI32)(TMP920));
		nimln(1284, "system.nim");
		res_136472 = addInt(res_136472, 1);
	} LA2: ;
	i_136456 = 0;
	HEX3Atmp_136475 = 0;
	nimln(499, "osproc.nim");
	nimln(499, "osproc.nim");
	HEX3Atmp_136475 = (aLen0-1);
	nimln(1281, "system.nim");
	res_136477 = 0;
	nimln(1282, "system.nim");
	while (1) {
		NI TMP921;
		NI TMP922;
		void* LOC5;
		NI TMP923;
		NI TMP924;
		nimln(1282, "system.nim");
		if (!(res_136477 <= HEX3Atmp_136475)) goto LA4;
		nimln(1281, "system.nim");
		i_136456 = res_136477;
		nimln(500, "osproc.nim");
		nimln(500, "osproc.nim");
		nimln(500, "osproc.nim");
		TMP921 = addInt(i_136456, bLen0);
		if ((NU)((NI32)(TMP921)) > (NU)(50000)) raiseIndexError();
		nimln(500, "osproc.nim");
		nimln(500, "osproc.nim");
		nimln(500, "osproc.nim");
		if ((NU)(i_136456) >= (NU)(aLen0)) raiseIndexError();
		TMP922 = addInt(a[i_136456]->Sup.len, 1);
		LOC5 = alloc_4001((NI32)(TMP922));
		result[((NI32)(TMP921))- 0] = ((NCSTRING) (LOC5));
		nimln(501, "osproc.nim");
		nimln(501, "osproc.nim");
		nimln(501, "osproc.nim");
		TMP923 = addInt(i_136456, bLen0);
		if ((NU)((NI32)(TMP923)) > (NU)(50000)) raiseIndexError();
		if ((NU)(i_136456) >= (NU)(aLen0)) raiseIndexError();
		nimln(501, "osproc.nim");
		nimln(501, "osproc.nim");
		if ((NU)(i_136456) >= (NU)(aLen0)) raiseIndexError();
		TMP924 = addInt(a[i_136456]->Sup.len, 1);
		memcpy(((void*) (result[((NI32)(TMP923))- 0])), ((void*) (a[i_136456]->data)), (NI32)(TMP924));
		nimln(1284, "system.nim");
		res_136477 = addInt(res_136477, 1);
	} LA4: ;
	popFrame();
	return result;
}

N_NIMCALL(NCSTRING*, tocstringarray_136482)(tstringtable103609* t) {
	NCSTRING* result;
	NI LOC1;
	NI TMP925;
	NI TMP926;
	void* LOC2;
	NI i;
	NimStringDesc* key_136488;
	NimStringDesc* val_136489;
	NI h_136508;
	NI HEX3Atmp_136510;
	NI res_136512;
	nimfr("ToCStringArray", "osproc.nim")
	result = 0;
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	LOC1 = nstlen(t);
	TMP925 = addInt(LOC1, 1);
	TMP926 = mulInt((NI32)(TMP925), 4);
	LOC2 = alloc0_4004((NI32)(TMP926));
	result = ((NCSTRING*) (LOC2));
	nimln(505, "osproc.nim");
	i = 0;
	key_136488 = 0;
	val_136489 = 0;
	h_136508 = 0;
	HEX3Atmp_136510 = 0;
	nimln(40, "strtabs.nim");
	nimln(40, "strtabs.nim");
	HEX3Atmp_136510 = ((*t).Data->Sup.len-1);
	nimln(1281, "system.nim");
	res_136512 = 0;
	nimln(1282, "system.nim");
	while (1) {
		nimln(1282, "system.nim");
		if (!(res_136512 <= HEX3Atmp_136510)) goto LA3;
		nimln(1281, "system.nim");
		h_136508 = res_136512;
		nimln(41, "strtabs.nim");
		{
			NimStringDesc* x;
			NimStringDesc* LOC8;
			NI TMP928;
			void* LOC9;
			NI TMP929;
			nimln(41, "strtabs.nim");
			nimln(41, "strtabs.nim");
			if ((NU)(h_136508) >= (NU)((*t).Data->Sup.len)) raiseIndexError();
			if (!!((*t).Data->data[h_136508].Field0 == 0)) goto LA6;
			nimln(42, "strtabs.nim");
			if ((NU)(h_136508) >= (NU)((*t).Data->Sup.len)) raiseIndexError();
			key_136488 = (*t).Data->data[h_136508].Field0;
			nimln(42, "strtabs.nim");
			if ((NU)(h_136508) >= (NU)((*t).Data->Sup.len)) raiseIndexError();
			val_136489 = (*t).Data->data[h_136508].Field1;
			nimln(507, "osproc.nim");
			nimln(507, "osproc.nim");
			LOC8 = 0;
			LOC8 = rawNewString(key_136488->Sup.len + val_136489->Sup.len + 1);
appendString(LOC8, key_136488);
appendString(LOC8, ((NimStringDesc*) &TMP927));
appendString(LOC8, val_136489);
			x = LOC8;
			nimln(508, "osproc.nim");
			if ((NU)(i) > (NU)(50000)) raiseIndexError();
			nimln(508, "osproc.nim");
			nimln(508, "osproc.nim");
			nimln(508, "osproc.nim");
			TMP928 = addInt(x->Sup.len, 1);
			LOC9 = alloc_4001((NI32)(TMP928));
			result[(i)- 0] = ((NCSTRING) (LOC9));
			nimln(509, "osproc.nim");
			if ((NU)(i) > (NU)(50000)) raiseIndexError();
			if ((NU)(0) > (NU)(x->Sup.len)) raiseIndexError();
			nimln(509, "osproc.nim");
			nimln(509, "osproc.nim");
			TMP929 = addInt(x->Sup.len, 1);
			memcpy(((void*) (result[(i)- 0])), ((void*) (&x->data[0])), (NI32)(TMP929));
			nimln(510, "osproc.nim");
			i = addInt(i, 1);
		}
		LA6: ;
		nimln(1284, "system.nim");
		res_136512 = addInt(res_136512, 1);
	} LA3: ;
	popFrame();
	return result;
}

N_NIMCALL(NCSTRING*, envtocstringarray_136515)(void) {
	NCSTRING* result;
	NI counter;
	NimStringDesc* key_136519;
	NimStringDesc* val_136520;
	NI i_136552;
	NI HEX3Atmp_136554;
	NI res_136556;
	NI TMP932;
	NI TMP933;
	void* LOC2;
	NI i;
	NimStringDesc* key_136535;
	NimStringDesc* val_136536;
	NI i_136568;
	NI HEX3Atmp_136570;
	NI res_136572;
	nimfr("EnvToCStringArray", "osproc.nim")
	result = 0;
	nimln(513, "osproc.nim");
	counter = 0;
	key_136519 = 0;
	val_136520 = 0;
	nimln(1032, "os.nim");
	getenvvarsc_95402();
	i_136552 = 0;
	HEX3Atmp_136554 = 0;
	nimln(1033, "os.nim");
	nimln(1033, "os.nim");
	HEX3Atmp_136554 = (environment_95235->Sup.len-1);
	nimln(1281, "system.nim");
	res_136556 = 0;
	nimln(1282, "system.nim");
	while (1) {
		NI p_136558;
		NI TMP930;
		NI TMP931;
		nimln(1282, "system.nim");
		if (!(res_136556 <= HEX3Atmp_136554)) goto LA1;
		nimln(1281, "system.nim");
		i_136552 = res_136556;
		nimln(1034, "os.nim");
		if ((NU)(i_136552) >= (NU)(environment_95235->Sup.len)) raiseIndexError();
		p_136558 = nsuFindChar(environment_95235->data[i_136552], 61, 0);
		nimln(1035, "os.nim");
		nimln(1035, "os.nim");
		if ((NU)(i_136552) >= (NU)(environment_95235->Sup.len)) raiseIndexError();
		nimln(1035, "os.nim");
		TMP930 = subInt(p_136558, 1);
		key_136519 = copyStrLast(environment_95235->data[i_136552], 0, (NI32)(TMP930));
		nimln(1036, "os.nim");
		nimln(1036, "os.nim");
		if ((NU)(i_136552) >= (NU)(environment_95235->Sup.len)) raiseIndexError();
		nimln(1036, "os.nim");
		TMP931 = addInt(p_136558, 1);
		val_136520 = copyStr(environment_95235->data[i_136552], (NI32)(TMP931));
		nimln(514, "osproc.nim");
		counter = addInt(counter, 1);
		nimln(1284, "system.nim");
		res_136556 = addInt(res_136556, 1);
	} LA1: ;
	nimln(515, "osproc.nim");
	nimln(515, "osproc.nim");
	nimln(515, "osproc.nim");
	nimln(515, "osproc.nim");
	TMP932 = addInt(counter, 1);
	TMP933 = mulInt((NI32)(TMP932), 4);
	LOC2 = alloc0_4004((NI32)(TMP933));
	result = ((NCSTRING*) (LOC2));
	nimln(516, "osproc.nim");
	i = 0;
	key_136535 = 0;
	val_136536 = 0;
	nimln(1032, "os.nim");
	getenvvarsc_95402();
	i_136568 = 0;
	HEX3Atmp_136570 = 0;
	nimln(1033, "os.nim");
	nimln(1033, "os.nim");
	HEX3Atmp_136570 = (environment_95235->Sup.len-1);
	nimln(1281, "system.nim");
	res_136572 = 0;
	nimln(1282, "system.nim");
	while (1) {
		NI p_136574;
		NI TMP934;
		NI TMP935;
		NimStringDesc* x;
		NimStringDesc* LOC4;
		NI TMP936;
		void* LOC5;
		NI TMP937;
		nimln(1282, "system.nim");
		if (!(res_136572 <= HEX3Atmp_136570)) goto LA3;
		nimln(1281, "system.nim");
		i_136568 = res_136572;
		nimln(1034, "os.nim");
		if ((NU)(i_136568) >= (NU)(environment_95235->Sup.len)) raiseIndexError();
		p_136574 = nsuFindChar(environment_95235->data[i_136568], 61, 0);
		nimln(1035, "os.nim");
		nimln(1035, "os.nim");
		if ((NU)(i_136568) >= (NU)(environment_95235->Sup.len)) raiseIndexError();
		nimln(1035, "os.nim");
		TMP934 = subInt(p_136574, 1);
		key_136535 = copyStrLast(environment_95235->data[i_136568], 0, (NI32)(TMP934));
		nimln(1036, "os.nim");
		nimln(1036, "os.nim");
		if ((NU)(i_136568) >= (NU)(environment_95235->Sup.len)) raiseIndexError();
		nimln(1036, "os.nim");
		TMP935 = addInt(p_136574, 1);
		val_136536 = copyStr(environment_95235->data[i_136568], (NI32)(TMP935));
		nimln(518, "osproc.nim");
		nimln(518, "osproc.nim");
		LOC4 = 0;
		LOC4 = rawNewString(key_136535->Sup.len + val_136536->Sup.len + 1);
appendString(LOC4, key_136535);
appendString(LOC4, ((NimStringDesc*) &TMP927));
appendString(LOC4, val_136536);
		x = LOC4;
		nimln(519, "osproc.nim");
		if ((NU)(i) > (NU)(50000)) raiseIndexError();
		nimln(519, "osproc.nim");
		nimln(519, "osproc.nim");
		nimln(519, "osproc.nim");
		TMP936 = addInt(x->Sup.len, 1);
		LOC5 = alloc_4001((NI32)(TMP936));
		result[(i)- 0] = ((NCSTRING) (LOC5));
		nimln(520, "osproc.nim");
		if ((NU)(i) > (NU)(50000)) raiseIndexError();
		if ((NU)(0) > (NU)(x->Sup.len)) raiseIndexError();
		nimln(520, "osproc.nim");
		nimln(520, "osproc.nim");
		TMP937 = addInt(x->Sup.len, 1);
		memcpy(((void*) (result[(i)- 0])), ((void*) (&x->data[0])), (NI32)(TMP937));
		nimln(521, "osproc.nim");
		i = addInt(i, 1);
		nimln(1284, "system.nim");
		res_136572 = addInt(res_136572, 1);
	} LA3: ;
	popFrame();
	return result;
}

static N_INLINE(void, setcurrentdir_93803)(NimStringDesc* newdir) {
	nimfr("setCurrentDir", "os.nim")
	nimln(461, "os.nim");
	{
		int LOC3;
		NI32 LOC6;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(461, "os.nim");
		LOC3 = chdir(newdir->data);
		if (!!((LOC3 == ((NI32) 0)))) goto LA4;
		nimln(461, "os.nim");
		nimln(461, "os.nim");
		LOC6 = oslasterror_92052();
		oserror_92005(LOC6);
	}
	LA4: ;
	popFrame();
}

N_NIMCALL(tprocess135203*, nospstartProcess)(NimStringDesc* command, NimStringDesc* workingdir, NimStringDesc** args, NI argsLen0, tstringtable103609* env, NU8 options) {
	tprocess135203* result;
	TY136594 pstdin;
	TY136594 pstdout;
	TY136594 pstderr;
	pid_t pid;
	posix_spawnattr_t attr;
	posix_spawn_file_actions_t fops;
	sigset_t mask;
	NCSTRING* e;
	NCSTRING* a;
	int res;
	int LOC120;
	int LOC121;
	nimfr("startProcess", "osproc.nim")
	result = 0;
	memset((void*)pstdin, 0, sizeof(pstdin));
	memset((void*)pstdout, 0, sizeof(pstdout));
	memset((void*)pstderr, 0, sizeof(pstderr));
	nimln(530, "osproc.nim");
	result = (tprocess135203*) newObj((&NTI135205), sizeof(tprocess135203));
	(*result).Sup.m_type = (&NTI135203);
	nimln(531, "osproc.nim");
	(*result).Exitcode = ((int) -3);
	nimln(532, "osproc.nim");
	{
		nimln(717, "system.nim");
		nimln(717, "system.nim");
		if (!!(((options &(1<<((((NU8) 3))&7)))!=0))) goto LA3;
		nimln(533, "osproc.nim");
		{
			NIM_BOOL LOC7;
			NIM_BOOL LOC8;
			int LOC9;
			int LOC11;
			int LOC13;
			NI32 LOC16;
			nimln(533, "osproc.nim");
			nimln(533, "osproc.nim");
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(533, "osproc.nim");
			LOC9 = pipe(pstdin);
			LOC8 = !((LOC9 == ((NI32) 0)));
			if (LOC8) goto LA10;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(533, "osproc.nim");
			LOC11 = pipe(pstdout);
			LOC8 = !((LOC11 == ((NI32) 0)));
			LA10: ;
			LOC7 = LOC8;
			if (LOC7) goto LA12;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(534, "osproc.nim");
			LOC13 = pipe(pstderr);
			LOC7 = !((LOC13 == ((NI32) 0)));
			LA12: ;
			if (!LOC7) goto LA14;
			nimln(535, "osproc.nim");
			nimln(535, "osproc.nim");
			LOC16 = oslasterror_92052();
			oserror_92005(LOC16);
		}
		LA14: ;
	}
	LA3: ;
	pid = 0;
	memset((void*)&attr, 0, sizeof(attr));
	memset((void*)&fops, 0, sizeof(fops));
	nimln(543, "osproc.nim");
	{
		int LOC19;
		NI32 LOC22;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(545, "osproc.nim");
		LOC19 = posix_spawn_file_actions_init(&fops);
		if (!!((LOC19 == ((NI32) 0)))) goto LA20;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC22 = oslasterror_92052();
		oserror_92005(LOC22);
	}
	LA20: ;
	nimln(543, "osproc.nim");
	{
		int LOC25;
		NI32 LOC28;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(546, "osproc.nim");
		LOC25 = posix_spawnattr_init(&attr);
		if (!!((LOC25 == ((NI32) 0)))) goto LA26;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC28 = oslasterror_92052();
		oserror_92005(LOC28);
	}
	LA26: ;
	memset((void*)&mask, 0, sizeof(mask));
	nimln(543, "osproc.nim");
	{
		int LOC31;
		NI32 LOC34;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(549, "osproc.nim");
		LOC31 = sigemptyset(&mask);
		if (!!((LOC31 == ((NI32) 0)))) goto LA32;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC34 = oslasterror_92052();
		oserror_92005(LOC34);
	}
	LA32: ;
	nimln(543, "osproc.nim");
	{
		int LOC37;
		NI32 LOC40;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(550, "osproc.nim");
		LOC37 = posix_spawnattr_setsigmask(&attr, &mask);
		if (!!((LOC37 == ((NI32) 0)))) goto LA38;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC40 = oslasterror_92052();
		oserror_92005(LOC40);
	}
	LA38: ;
	nimln(543, "osproc.nim");
	{
		int LOC43;
		NI32 LOC46;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(551, "osproc.nim");
		LOC43 = posix_spawnattr_setpgroup(&attr, 0);
		if (!!((LOC43 == ((NI32) 0)))) goto LA44;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC46 = oslasterror_92052();
		oserror_92005(LOC46);
	}
	LA44: ;
	nimln(543, "osproc.nim");
	{
		int LOC49;
		NI32 LOC52;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(553, "osproc.nim");
		nimln(554, "osproc.nim");
		nimln(553, "osproc.nim");
		LOC49 = posix_spawnattr_setflags(&attr, (NI32)((NI32)(POSIX_SPAWN_USEVFORK | POSIX_SPAWN_SETSIGMASK) | POSIX_SPAWN_SETPGROUP));
		if (!!((LOC49 == ((NI32) 0)))) goto LA50;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC52 = oslasterror_92052();
		oserror_92005(LOC52);
	}
	LA50: ;
	nimln(557, "osproc.nim");
	{
		nimln(717, "system.nim");
		nimln(717, "system.nim");
		if (!!(((options &(1<<((((NU8) 3))&7)))!=0))) goto LA55;
		nimln(543, "osproc.nim");
		{
			int LOC59;
			NI32 LOC62;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(558, "osproc.nim");
			LOC59 = posix_spawn_file_actions_addclose(&fops, pstdin[(1)- 0]);
			if (!!((LOC59 == ((NI32) 0)))) goto LA60;
			nimln(543, "osproc.nim");
			nimln(543, "osproc.nim");
			LOC62 = oslasterror_92052();
			oserror_92005(LOC62);
		}
		LA60: ;
		nimln(543, "osproc.nim");
		{
			int LOC65;
			NI32 LOC68;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(559, "osproc.nim");
			LOC65 = posix_spawn_file_actions_adddup2(&fops, pstdin[(0)- 0], ((int) 0));
			if (!!((LOC65 == ((NI32) 0)))) goto LA66;
			nimln(543, "osproc.nim");
			nimln(543, "osproc.nim");
			LOC68 = oslasterror_92052();
			oserror_92005(LOC68);
		}
		LA66: ;
		nimln(543, "osproc.nim");
		{
			int LOC71;
			NI32 LOC74;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(560, "osproc.nim");
			LOC71 = posix_spawn_file_actions_addclose(&fops, pstdout[(0)- 0]);
			if (!!((LOC71 == ((NI32) 0)))) goto LA72;
			nimln(543, "osproc.nim");
			nimln(543, "osproc.nim");
			LOC74 = oslasterror_92052();
			oserror_92005(LOC74);
		}
		LA72: ;
		nimln(543, "osproc.nim");
		{
			int LOC77;
			NI32 LOC80;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(561, "osproc.nim");
			LOC77 = posix_spawn_file_actions_adddup2(&fops, pstdout[(1)- 0], ((int) 1));
			if (!!((LOC77 == ((NI32) 0)))) goto LA78;
			nimln(543, "osproc.nim");
			nimln(543, "osproc.nim");
			LOC80 = oslasterror_92052();
			oserror_92005(LOC80);
		}
		LA78: ;
		nimln(543, "osproc.nim");
		{
			int LOC83;
			NI32 LOC86;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(562, "osproc.nim");
			LOC83 = posix_spawn_file_actions_addclose(&fops, pstderr[(0)- 0]);
			if (!!((LOC83 == ((NI32) 0)))) goto LA84;
			nimln(543, "osproc.nim");
			nimln(543, "osproc.nim");
			LOC86 = oslasterror_92052();
			oserror_92005(LOC86);
		}
		LA84: ;
		nimln(563, "osproc.nim");
		{
			nimln(716, "system.nim");
			if (!((options &(1<<((((NU8) 2))&7)))!=0)) goto LA89;
			nimln(543, "osproc.nim");
			{
				int LOC93;
				NI32 LOC96;
				nimln(684, "system.nim");
				nimln(684, "system.nim");
				nimln(564, "osproc.nim");
				LOC93 = posix_spawn_file_actions_adddup2(&fops, pstdout[(1)- 0], ((int) 2));
				if (!!((LOC93 == ((NI32) 0)))) goto LA94;
				nimln(543, "osproc.nim");
				nimln(543, "osproc.nim");
				LOC96 = oslasterror_92052();
				oserror_92005(LOC96);
			}
			LA94: ;
		}
		goto LA87;
		LA89: ;
		{
			nimln(543, "osproc.nim");
			{
				int LOC100;
				NI32 LOC103;
				nimln(684, "system.nim");
				nimln(684, "system.nim");
				nimln(566, "osproc.nim");
				LOC100 = posix_spawn_file_actions_adddup2(&fops, pstderr[(1)- 0], ((int) 2));
				if (!!((LOC100 == ((NI32) 0)))) goto LA101;
				nimln(543, "osproc.nim");
				nimln(543, "osproc.nim");
				LOC103 = oslasterror_92052();
				oserror_92005(LOC103);
			}
			LA101: ;
		}
		LA87: ;
	}
	LA55: ;
	nimln(568, "osproc.nim");
	nimln(568, "osproc.nim");
	{
		nimln(568, "osproc.nim");
		if (!(env == NIM_NIL)) goto LA106;
		nimln(568, "osproc.nim");
		e = envtocstringarray_136515();
	}
	goto LA104;
	LA106: ;
	{
		nimln(568, "osproc.nim");
		e = tocstringarray_136482(env);
	}
	LA104: ;
	a = 0;
	res = 0;
	nimln(571, "osproc.nim");
	{
		nimln(692, "system.nim");
		nimln(571, "osproc.nim");
		if (!(0 < workingdir->Sup.len)) goto LA111;
		nimln(571, "osproc.nim");
		setcurrentdir_93803(workingdir);
	}
	LA111: ;
	nimln(572, "osproc.nim");
	{
		TY105474 LOC117;
		nimln(717, "system.nim");
		nimln(717, "system.nim");
		if (!!(((options &(1<<((((NU8) 1))&7)))!=0))) goto LA115;
		nimln(573, "osproc.nim");
		memset((void*)LOC117, 0, sizeof(LOC117));
		nimln(573, "osproc.nim");
		LOC117[0] = nosextractFilename(command);
		a = tocstringarray_136424(LOC117, 1, args, argsLen0);
		nimln(574, "osproc.nim");
		res = posix_spawn(&pid, command->data, &fops, &attr, a, e);
	}
	goto LA113;
	LA115: ;
	{
		NimStringDesc* x;
		TY105474 LOC119;
		nimln(576, "osproc.nim");
		x = addcmdargs_136404(command, args, argsLen0);
		nimln(577, "osproc.nim");
		memset((void*)LOC119, 0, sizeof(LOC119));
		LOC119[0] = copyString(x);
		a = tocstringarray_136424(TMP938, 2, LOC119, 1);
		nimln(578, "osproc.nim");
		res = posix_spawn(&pid, "/bin/sh", &fops, &attr, a, e);
	}
	LA113: ;
	nimln(579, "osproc.nim");
	dealloccstringarray_9637(a);
	nimln(580, "osproc.nim");
	dealloccstringarray_9637(e);
	nimln(581, "osproc.nim");
	nimln(581, "osproc.nim");
	LOC120 = posix_spawn_file_actions_destroy(&fops);
	nimln(582, "osproc.nim");
	nimln(582, "osproc.nim");
	LOC121 = posix_spawnattr_destroy(&attr);
	nimln(543, "osproc.nim");
	{
		NI32 LOC126;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!((res == ((NI32) 0)))) goto LA124;
		nimln(543, "osproc.nim");
		nimln(543, "osproc.nim");
		LOC126 = oslasterror_92052();
		oserror_92005(LOC126);
	}
	LA124: ;
	nimln(623, "osproc.nim");
	{
		NimStringDesc* LOC131;
		nimln(716, "system.nim");
		if (!((options &(1<<((((NU8) 0))&7)))!=0)) goto LA129;
		nimln(624, "osproc.nim");
		nimln(624, "osproc.nim");
		LOC131 = 0;
		LOC131 = nsuJoinSep(args, argsLen0, ((NimStringDesc*) &TMP915));
		printf("%s%s%s\012", (command)->data, (((NimStringDesc*) &TMP915))->data, (LOC131)->data);
	}
	LA129: ;
	nimln(625, "osproc.nim");
	(*result).Id = pid;
	nimln(627, "osproc.nim");
	{
		nimln(716, "system.nim");
		if (!((options &(1<<((((NU8) 3))&7)))!=0)) goto LA134;
		nimln(629, "osproc.nim");
		(*result).Inputhandle = ((int) 0);
		nimln(630, "osproc.nim");
		(*result).Outputhandle = ((int) 1);
		nimln(631, "osproc.nim");
		{
			nimln(716, "system.nim");
			if (!((options &(1<<((((NU8) 2))&7)))!=0)) goto LA138;
			nimln(632, "osproc.nim");
			(*result).Errorhandle = (*result).Outputhandle;
		}
		goto LA136;
		LA138: ;
		{
			nimln(634, "osproc.nim");
			(*result).Errorhandle = ((int) 2);
		}
		LA136: ;
	}
	goto LA132;
	LA134: ;
	{
		int LOC148;
		int LOC149;
		int LOC150;
		nimln(636, "osproc.nim");
		(*result).Inputhandle = pstdin[(1)- 0];
		nimln(637, "osproc.nim");
		(*result).Outputhandle = pstdout[(0)- 0];
		nimln(638, "osproc.nim");
		{
			int LOC146;
			nimln(716, "system.nim");
			if (!((options &(1<<((((NU8) 2))&7)))!=0)) goto LA144;
			nimln(639, "osproc.nim");
			(*result).Errorhandle = (*result).Outputhandle;
			nimln(640, "osproc.nim");
			nimln(640, "osproc.nim");
			LOC146 = close(pstderr[(0)- 0]);
		}
		goto LA142;
		LA144: ;
		{
			nimln(642, "osproc.nim");
			(*result).Errorhandle = pstderr[(0)- 0];
		}
		LA142: ;
		nimln(643, "osproc.nim");
		nimln(643, "osproc.nim");
		LOC148 = close(pstderr[(1)- 0]);
		nimln(644, "osproc.nim");
		nimln(644, "osproc.nim");
		LOC149 = close(pstdin[(0)- 0]);
		nimln(645, "osproc.nim");
		nimln(645, "osproc.nim");
		LOC150 = close(pstdout[(1)- 0]);
	}
	LA132: ;
	popFrame();
	return result;
}

N_NIMCALL(void, nospclose)(tprocess135203* p) {
	int LOC13;
	int LOC14;
	int LOC15;
	nimfr("close", "osproc.nim")
	nimln(648, "osproc.nim");
	{
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!(((*p).Instream == NIM_NIL))) goto LA3;
		nimln(648, "osproc.nim");
		close_133675((*p).Instream);
	}
	LA3: ;
	nimln(649, "osproc.nim");
	{
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!(((*p).Outstream == NIM_NIL))) goto LA7;
		nimln(649, "osproc.nim");
		close_133675((*p).Outstream);
	}
	LA7: ;
	nimln(650, "osproc.nim");
	{
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!(((*p).Errstream == NIM_NIL))) goto LA11;
		nimln(650, "osproc.nim");
		close_133675((*p).Errstream);
	}
	LA11: ;
	nimln(651, "osproc.nim");
	nimln(651, "osproc.nim");
	LOC13 = close((*p).Inputhandle);
	nimln(652, "osproc.nim");
	nimln(652, "osproc.nim");
	LOC14 = close((*p).Outputhandle);
	nimln(653, "osproc.nim");
	nimln(653, "osproc.nim");
	LOC15 = close((*p).Errorhandle);
	popFrame();
}

N_NIMCALL(void, nospsuspend)(tprocess135203* p) {
	nimfr("suspend", "osproc.nim")
	nimln(656, "osproc.nim");
	{
		int LOC3;
		NI32 LOC6;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(656, "osproc.nim");
		nimln(656, "osproc.nim");
		if ((*p).Id == (-2147483647 -1)) raiseOverflow();
		LOC3 = kill(((NI32)-((*p).Id)), SIGSTOP);
		if (!!((LOC3 == ((NI32) 0)))) goto LA4;
		nimln(656, "osproc.nim");
		nimln(656, "osproc.nim");
		LOC6 = oslasterror_92052();
		oserror_92005(LOC6);
	}
	LA4: ;
	popFrame();
}

N_NIMCALL(void, nospresume)(tprocess135203* p) {
	nimfr("resume", "osproc.nim")
	nimln(659, "osproc.nim");
	{
		int LOC3;
		NI32 LOC6;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		nimln(659, "osproc.nim");
		nimln(659, "osproc.nim");
		if ((*p).Id == (-2147483647 -1)) raiseOverflow();
		LOC3 = kill(((NI32)-((*p).Id)), SIGCONT);
		if (!!((LOC3 == ((NI32) 0)))) goto LA4;
		nimln(659, "osproc.nim");
		nimln(659, "osproc.nim");
		LOC6 = oslasterror_92052();
		oserror_92005(LOC6);
	}
	LA4: ;
	popFrame();
}

N_NIMCALL(NIM_BOOL, nosprunning)(tprocess135203* p) {
	NIM_BOOL result;
	pid_t ret;
	nimfr("running", "osproc.nim")
	result = 0;
	nimln(662, "osproc.nim");
	ret = waitpid((*p).Id, &(*p).Exitcode, WNOHANG);
	nimln(663, "osproc.nim");
	{
		nimln(663, "osproc.nim");
		if (!(ret == 0)) goto LA3;
		nimln(663, "osproc.nim");
		nimln(663, "osproc.nim");
		result = NIM_TRUE;
		goto BeforeRet;
	}
	LA3: ;
	nimln(664, "osproc.nim");
	nimln(664, "osproc.nim");
	result = (ret == (*p).Id);
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, nospterminate)(tprocess135203* p) {
	nimfr("terminate", "osproc.nim")
	nimln(667, "osproc.nim");
	{
		int LOC3;
		nimln(667, "osproc.nim");
		nimln(667, "osproc.nim");
		nimln(667, "osproc.nim");
		if ((*p).Id == (-2147483647 -1)) raiseOverflow();
		LOC3 = kill(((NI32)-((*p).Id)), SIGTERM);
		if (!(LOC3 == ((NI32) 0))) goto LA4;
		nimln(668, "osproc.nim");
		{
			NIM_BOOL LOC8;
			nimln(668, "osproc.nim");
			LOC8 = nosprunning(p);
			if (!LOC8) goto LA9;
			nimln(669, "osproc.nim");
			{
				int LOC13;
				NI32 LOC16;
				nimln(684, "system.nim");
				nimln(684, "system.nim");
				nimln(669, "osproc.nim");
				nimln(669, "osproc.nim");
				if ((*p).Id == (-2147483647 -1)) raiseOverflow();
				LOC13 = kill(((NI32)-((*p).Id)), SIGKILL);
				if (!!((LOC13 == ((NI32) 0)))) goto LA14;
				nimln(669, "osproc.nim");
				nimln(669, "osproc.nim");
				LOC16 = oslasterror_92052();
				oserror_92005(LOC16);
			}
			LA14: ;
		}
		LA9: ;
	}
	goto LA1;
	LA4: ;
	{
		NI32 LOC18;
		nimln(670, "osproc.nim");
		nimln(670, "osproc.nim");
		LOC18 = oslasterror_92052();
		oserror_92005(LOC18);
	}
	LA1: ;
	popFrame();
}

N_NIMCALL(NI, nospwaitForExit)(tprocess135203* p, NI timeout) {
	NI result;
	nimfr("waitForExit", "osproc.nim")
	result = 0;
	nimln(677, "osproc.nim");
	{
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!(((*p).Exitcode == ((NI32) -3)))) goto LA3;
		nimln(677, "osproc.nim");
		nimln(677, "osproc.nim");
		result = ((NI) ((*p).Exitcode));
		goto BeforeRet;
	}
	LA3: ;
	nimln(678, "osproc.nim");
	{
		pid_t LOC7;
		NI32 LOC10;
		nimln(678, "osproc.nim");
		nimln(678, "osproc.nim");
		LOC7 = waitpid((*p).Id, &(*p).Exitcode, ((int) 0));
		if (!(LOC7 < 0)) goto LA8;
		nimln(679, "osproc.nim");
		(*p).Exitcode = ((int) -3);
		nimln(680, "osproc.nim");
		nimln(680, "osproc.nim");
		LOC10 = oslasterror_92052();
		oserror_92005(LOC10);
	}
	LA8: ;
	nimln(681, "osproc.nim");
	nimln(681, "osproc.nim");
	result = (NI)((NU32)(((NI) ((*p).Exitcode))) >> (NU32)(8));
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(NI, peekexitcode_135331)(tprocess135203* p) {
	NI result;
	pid_t ret;
	NIM_BOOL b;
	nimfr("peekExitCode", "osproc.nim")
	result = 0;
	nimln(684, "osproc.nim");
	{
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!(((*p).Exitcode == ((NI32) -3)))) goto LA3;
		nimln(684, "osproc.nim");
		nimln(684, "osproc.nim");
		result = ((NI) ((*p).Exitcode));
		goto BeforeRet;
	}
	LA3: ;
	nimln(685, "osproc.nim");
	ret = waitpid((*p).Id, &(*p).Exitcode, WNOHANG);
	nimln(686, "osproc.nim");
	nimln(686, "osproc.nim");
	b = (ret == (*p).Id);
	nimln(687, "osproc.nim");
	{
		if (!b) goto LA7;
		nimln(687, "osproc.nim");
		result = -1;
	}
	LA7: ;
	nimln(688, "osproc.nim");
	{
		nimln(688, "osproc.nim");
		if (!((*p).Exitcode == ((NI32) -3))) goto LA11;
		nimln(688, "osproc.nim");
		result = -1;
	}
	goto LA9;
	LA11: ;
	{
		nimln(689, "osproc.nim");
		nimln(689, "osproc.nim");
		result = (NI)((NU32)(((NI) ((*p).Exitcode))) >> (NU32)(8));
	}
	LA9: ;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, createstream_137009)(tstream133630** stream, NI32* handle, NU8 filemode) {
	FILE* f;
	tfilestream134125* LOC7;
	nimfr("createStream", "osproc.nim")
	f = 0;
	nimln(694, "osproc.nim");
	{
		NIM_BOOL LOC3;
		NI32 LOC6;
		nimln(694, "osproc.nim");
		nimln(694, "osproc.nim");
		LOC3 = open_9026(&f, (*handle), filemode);
		if (!!(LOC3)) goto LA4;
		nimln(694, "osproc.nim");
		nimln(694, "osproc.nim");
		LOC6 = oslasterror_92052();
		oserror_92005(LOC6);
	}
	LA4: ;
	nimln(695, "osproc.nim");
	nimln(695, "osproc.nim");
	LOC7 = 0;
	LOC7 = newfilestream_134182(f);
	unsureAsgnRef((void**) &(*stream), &LOC7->Sup);
	popFrame();
}

N_NIMCALL(tstream133630*, nospinputStream)(tprocess135203* p) {
	tstream133630* result;
	nimfr("inputStream", "osproc.nim")
	result = 0;
	nimln(698, "osproc.nim");
	{
		nimln(698, "osproc.nim");
		if (!((*p).Instream == NIM_NIL)) goto LA3;
		nimln(699, "osproc.nim");
		createstream_137009(&(*p).Instream, &(*p).Inputhandle, ((NU8) 1));
	}
	LA3: ;
	nimln(700, "osproc.nim");
	nimln(700, "osproc.nim");
	result = (*p).Instream;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(tstream133630*, nospoutputStream)(tprocess135203* p) {
	tstream133630* result;
	nimfr("outputStream", "osproc.nim")
	result = 0;
	nimln(703, "osproc.nim");
	{
		nimln(703, "osproc.nim");
		if (!((*p).Outstream == NIM_NIL)) goto LA3;
		nimln(704, "osproc.nim");
		createstream_137009(&(*p).Outstream, &(*p).Outputhandle, ((NU8) 0));
	}
	LA3: ;
	nimln(705, "osproc.nim");
	nimln(705, "osproc.nim");
	result = (*p).Outstream;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(tstream133630*, nosperrorStream)(tprocess135203* p) {
	tstream133630* result;
	nimfr("errorStream", "osproc.nim")
	result = 0;
	nimln(708, "osproc.nim");
	{
		nimln(708, "osproc.nim");
		if (!((*p).Errstream == NIM_NIL)) goto LA3;
		nimln(709, "osproc.nim");
		createstream_137009(&(*p).Errstream, &(*p).Errorhandle, ((NU8) 0));
	}
	LA3: ;
	nimln(710, "osproc.nim");
	nimln(710, "osproc.nim");
	result = (*p).Errstream;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(NI, nospexecCmd)(NimStringDesc* command) {
	NI result;
	int LOC1;
	nimfr("execCmd", "osproc.nim")
	result = 0;
	nimln(715, "osproc.nim");
	nimln(715, "osproc.nim");
	LOC1 = system(command->data);
	result = ((NI) (LOC1));
	popFrame();
	return result;
}

N_NIMCALL(void, createfdset_137082)(fd_set* fd, TY136003* s, NI* m) {
	tprocess135203* i_137125;
	NI i_137133;
	nimfr("createFdSet", "osproc.nim")
	nimln(718, "osproc.nim");
	FD_ZERO(fd);
	i_137125 = 0;
	nimln(1366, "system.nim");
	i_137133 = 0;
	nimln(1367, "system.nim");
	while (1) {
		nimln(1367, "system.nim");
		nimln(1367, "system.nim");
		if (!(i_137133 < s->Sup.len)) goto LA1;
		nimln(1368, "system.nim");
		if ((NU)(i_137133) >= (NU)(s->Sup.len)) raiseIndexError();
		i_137125 = s->data[i_137133];
		nimln(720, "osproc.nim");
		nimln(720, "osproc.nim");
		(*m) = (((*m) >= ((NI) ((*i_137125).Outputhandle))) ? (*m) : ((NI) ((*i_137125).Outputhandle)));
		nimln(721, "osproc.nim");
		FD_SET((*i_137125).Outputhandle, fd);
		nimln(1369, "system.nim");
		i_137133 = addInt(i_137133, 1);
	} LA1: ;
	popFrame();
}

N_NIMCALL(void, pruneprocessset_137136)(TY136003** s, fd_set* fd) {
	NI i;
	NI l;
	nimfr("pruneProcessSet", "osproc.nim")
	nimln(724, "osproc.nim");
	i = 0;
	nimln(725, "osproc.nim");
	nimln(725, "osproc.nim");
	l = (*s)->Sup.len;
	nimln(726, "osproc.nim");
	while (1) {
		nimln(726, "osproc.nim");
		if (!(i < l)) goto LA1;
		nimln(727, "osproc.nim");
		{
			int LOC4;
			NI TMP944;
			nimln(684, "system.nim");
			nimln(684, "system.nim");
			nimln(727, "osproc.nim");
			if ((NU)(i) >= (NU)((*s)->Sup.len)) raiseIndexError();
			LOC4 = FD_ISSET((*(*s)->data[i]).Outputhandle, fd);
			if (!!((LOC4 == ((NI32) 0)))) goto LA5;
			nimln(728, "osproc.nim");
			if ((NU)(i) >= (NU)((*s)->Sup.len)) raiseIndexError();
			nimln(728, "osproc.nim");
			TMP944 = subInt(l, 1);
			if ((NU)((NI32)(TMP944)) >= (NU)((*s)->Sup.len)) raiseIndexError();
			asgnRefNoCycle((void**) &(*s)->data[i], (*s)->data[(NI32)(TMP944)]);
			nimln(729, "osproc.nim");
			l = subInt(l, 1);
		}
		goto LA2;
		LA5: ;
		{
			nimln(731, "osproc.nim");
			i = addInt(i, 1);
		}
		LA2: ;
	} LA1: ;
	nimln(732, "osproc.nim");
	(*s) = (TY136003*) setLengthSeq(&((*s))->Sup, sizeof(tprocess135203*), l);
	popFrame();
}

N_NIMCALL(NI, select_136301)(TY136003** readfds, NI timeout) {
	NI result;
	struct timeval tv;
	NI TMP945;
	fd_set rd;
	NI m;
	nimfr("select", "osproc.nim")
	result = 0;
	memset((void*)&tv, 0, sizeof(tv));
	nimln(736, "osproc.nim");
	tv.tv_sec = 0;
	nimln(737, "osproc.nim");
	nimln(737, "osproc.nim");
	TMP945 = mulInt(timeout, 1000);
	tv.tv_usec = (NI32)(TMP945);
	memset((void*)&rd, 0, sizeof(rd));
	nimln(740, "osproc.nim");
	m = 0;
	nimln(741, "osproc.nim");
	createfdset_137082(&rd, (*readfds), &m);
	nimln(743, "osproc.nim");
	{
		NI TMP946;
		int LOC5;
		nimln(684, "system.nim");
		nimln(684, "system.nim");
		if (!!((timeout == -1))) goto LA3;
		nimln(744, "osproc.nim");
		nimln(744, "osproc.nim");
		nimln(744, "osproc.nim");
		TMP946 = addInt(m, 1);
		LOC5 = select(((int) ((NI32)(TMP946))), &rd, NIM_NIL, NIM_NIL, &tv);
		result = ((NI) (LOC5));
	}
	goto LA1;
	LA3: ;
	{
		NI TMP947;
		int LOC7;
		nimln(746, "osproc.nim");
		nimln(746, "osproc.nim");
		nimln(746, "osproc.nim");
		TMP947 = addInt(m, 1);
		LOC7 = select(((int) ((NI32)(TMP947))), &rd, NIM_NIL, NIM_NIL, NIM_NIL);
		result = ((NI) (LOC7));
	}
	LA1: ;
	nimln(748, "osproc.nim");
	pruneprocessset_137136(readfds, &rd);
	popFrame();
	return result;
}

N_NIMCALL(void, execcmdex_137402)(NimStringDesc* command, NU8 options, TY71482* Result) {
	tprocess135203* p;
	tstream133630* outp;
	NimStringDesc* line;
	nimfr("execCmdEx", "osproc.nim")
	nimln(757, "osproc.nim");
	p = startcmd_135246(command, options);
	nimln(758, "osproc.nim");
	outp = nospoutputStream(p);
	nimln(759, "osproc.nim");
	unsureAsgnRef((void**) &(*Result).Field0, copyString(TMP948.Field0));
	(*Result).Field1 = TMP948.Field1;
	nimln(760, "osproc.nim");
	nimln(760, "osproc.nim");
	line = rawNewString(120);
	nimln(761, "osproc.nim");
	while (1) {
		nimln(762, "osproc.nim");
		{
			NIM_BOOL LOC4;
			nimln(762, "osproc.nim");
			LOC4 = readline_133979(outp, &line);
			if (!LOC4) goto LA5;
			nimln(763, "osproc.nim");
			(*Result).Field0 = resizeString((*Result).Field0, line->Sup.len + 0);
appendString((*Result).Field0, line);
			nimln(764, "osproc.nim");
			(*Result).Field0 = resizeString((*Result).Field0, 1);
appendString((*Result).Field0, ((NimStringDesc*) &TMP913));
		}
		goto LA2;
		LA5: ;
		{
			nimln(766, "osproc.nim");
			(*Result).Field1 = peekexitcode_135331(p);
			nimln(767, "osproc.nim");
			{
				nimln(684, "system.nim");
				nimln(684, "system.nim");
				if (!!(((*Result).Field1 == -1))) goto LA10;
				nimln(767, "osproc.nim");
				goto LA1;
			}
			LA10: ;
		}
		LA2: ;
	} LA1: ;
	nimln(768, "osproc.nim");
	nospclose(p);
	popFrame();
}
N_NOINLINE(void, osprocInit)(void) {
	nimfr("osproc", "osproc.nim")
	popFrame();
}

N_NOINLINE(void, osprocDatInit)(void) {
static TNimNode* TMP901[8];
static TNimNode TMP883[9];
NTI135203.size = sizeof(tprocess135203);
NTI135203.kind = 17;
NTI135203.base = (&NTI1009);
NTI135203.flags = 2;
TMP901[0] = &TMP883[1];
TMP883[1].kind = 1;
TMP883[1].offset = offsetof(tprocess135203, Inputhandle);
TMP883[1].typ = (&NTI9008);
TMP883[1].name = "inputHandle";
TMP901[1] = &TMP883[2];
TMP883[2].kind = 1;
TMP883[2].offset = offsetof(tprocess135203, Outputhandle);
TMP883[2].typ = (&NTI9008);
TMP883[2].name = "outputHandle";
TMP901[2] = &TMP883[3];
TMP883[3].kind = 1;
TMP883[3].offset = offsetof(tprocess135203, Errorhandle);
TMP883[3].typ = (&NTI9008);
TMP883[3].name = "errorHandle";
TMP901[3] = &TMP883[4];
TMP883[4].kind = 1;
TMP883[4].offset = offsetof(tprocess135203, Instream);
TMP883[4].typ = (&NTI133628);
TMP883[4].name = "inStream";
TMP901[4] = &TMP883[5];
TMP883[5].kind = 1;
TMP883[5].offset = offsetof(tprocess135203, Outstream);
TMP883[5].typ = (&NTI133628);
TMP883[5].name = "outStream";
TMP901[5] = &TMP883[6];
TMP883[6].kind = 1;
TMP883[6].offset = offsetof(tprocess135203, Errstream);
TMP883[6].typ = (&NTI133628);
TMP883[6].name = "errStream";
TMP901[6] = &TMP883[7];
TMP883[7].kind = 1;
TMP883[7].offset = offsetof(tprocess135203, Id);
TMP883[7].typ = (&NTI84455);
TMP883[7].name = "id";
TMP901[7] = &TMP883[8];
TMP883[8].kind = 1;
TMP883[8].offset = offsetof(tprocess135203, Exitcode);
TMP883[8].typ = (&NTI3701);
TMP883[8].name = "exitCode";
TMP883[0].len = 8; TMP883[0].kind = 2; TMP883[0].sons = &TMP901[0];
NTI135203.node = &TMP883[0];
NTI135205.size = sizeof(tprocess135203*);
NTI135205.kind = 22;
NTI135205.base = (&NTI135203);
NTI135205.flags = 2;
NTI135205.marker = TMP903;
NTI136003.size = sizeof(TY136003*);
NTI136003.kind = 24;
NTI136003.base = (&NTI135205);
NTI136003.flags = 2;
NTI136003.marker = TMP904;
}

